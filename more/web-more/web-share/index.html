<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="方志的个人博客,fangzhioo,blog">
    <meta name="keyword"  content="方志,fangzhioo,Fz&#39;s Blog,Kirito,桐人,博客,互联网,Web,JavaScript,Html,Css,Vue.js,React.js,前端,设计,React.js, TypeScript, Antd, Umi.js, Pont">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          【分享】在阿里DT完成一系列产品后，分享下团队前端部分的技术选型～ - 方志 | fangzhioo
        
    </title>

    <link rel="canonical" href="https://fangzhioo.github.io/more/web-more/web-share/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
<link rel="stylesheet" href="/css/beantech.min.css">


    
<link rel="stylesheet" href="/css/donate.css">

    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/prism.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/toc.css">


    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script>
      // ga
      window.onload = function() {
        setTimeout(function() {
          let script = document.createElement("script");
          script.setAttribute("async", "");
          script.src = "//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3409699730406381";
          document.body.appendChild(script);
        }, 2e3);
      }
    </script>

    <!--不蒜子-->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- jQuery -->
    <!-- 
<script src="/js/jquery.min.js"></script>
 -->
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <!-- 
<script src="/js/bootstrap.min.js"></script>
 -->
    <script src="https://cdn.bootcss.com/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <!-- google ad -->
    <script data-ad-client="ca-pub-3409699730406381" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('//www.talklee.com/api/bing?rand=true')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Share" title="Share">Share</a>
                            
                        </div>
                        <h1>【分享】在阿里DT完成一系列产品后，分享下团队前端部分的技术选型～</h1>
                        <h2 class="subheading">主要是分享这段时间，开发所运用的技术栈，个人觉得比较实用，分享给大家参考下～</h2>

                        <!--文章访问量统计-->
                        
                            <span id="busuanzi_container_page_pv">本文已被阅读过<span id="busuanzi_value_page_pv"></span>次</span>
                        
                        <!--文章访问量统计-->

                        <span class="meta">
                            Posted by 方志 on
                            2020-05-17
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Fz Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    
                        <li>
                            <a href="/archive/" >Archives</a>
                        </li>
                    
                        <li>
                            <a href="/tags/" >Tags</a>
                        </li>
                    
                        <li>
                            <a href="/about/" >About</a>
                        </li>
                    

                    <!-- 

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/love/">✨致我的小可爱💕～</a>
                        </li>
                        
                    

                        
                    

                        
                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                     -->
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h1 id="开发环境准备"><a href="#开发环境准备" class="headerlink" title="开发环境准备"></a>开发环境准备</h1><h2 id="node"><a href="#node" class="headerlink" title="node"></a>node</h2><h3 id="安装-node-js-npm"><a href="#安装-node-js-npm" class="headerlink" title="安装 node.js / npm"></a>安装 node.js / npm</h3><p>尽量安装 10.x 以上版本。如果已经安装好了 node.js，那么其中已经自带<strong>npm</strong>（包管理工具）。</p>
<hr>
<h2 id="vscode-代码编辑器"><a href="#vscode-代码编辑器" class="headerlink" title="vscode 代码编辑器"></a>vscode 代码编辑器</h2><p>前端代码推荐使用 vscode 开发，因为需要配合后面用到的<strong>pont</strong>接口层生成工具，还有就是对 <code>typescript</code> 比较友好。</p>
<p>可以去官网自行下载安装 <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">官方站点</a>。</p>
<p>在插件拓展里，可以搜索安装需要的插件。来对 <code>React.js</code> 、<code>typescript</code> 等更加友好的支持。</p>
<p>常见的插件有如下：</p>
<ul>
<li>软件中文包：Chinese (Simplified) Language Pack for Visual Studio Code</li>
<li>代码 lint：ESLint</li>
<li>路径补全：Path Autocomplete</li>
<li>代码美化：prettier</li>
<li>接口工具：Pont</li>
<li>React 支持： ES7 React/Redux/GraphQL/React-Native snippets</li>
<li>Git 拓展： GitLens — Git supercharged</li>
<li>开发辅助： Visual Studio IntelliCode</li>
<li>……</li>
</ul>
<hr>
<h1 id="前端语言和框架"><a href="#前端语言和框架" class="headerlink" title="前端语言和框架"></a>前端语言和框架</h1><hr>
<h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><p>对于 <code>javascript</code> ，我们并不陌生，这里说的 <code>ES6</code>，甚至 ES7、ES8 等又是什么回事？</p>
<blockquote>
<p>ECMAScript 6.0（简称 ES6）是 JavaScript 语言的下一代标准，已经在 2015 年 6 月正式发布。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。</p>
</blockquote>
<p>这里特别说到 ES6，是因为从 ES5 到 ES6，有了很大的变化，且我们的项目中，都是以 ES6 为标准书写的代码。所以我们这里简单介绍少 ES6 中的常用写法，方便后续代码的理解和书写。</p>
<h3 id="const、let-和-var"><a href="#const、let-和-var" class="headerlink" title="const、let 和 var"></a>const、let 和 var</h3><p><code>const</code>、<code>let</code>和<code>var</code>都是用来声明变量的作用。<code>const</code>和<code>let</code>是 ES6 开始引入的概念。 <code>const</code> 用来表示常量，一旦声明就无法改变值。 但这是指基本数据类型，对数组和对象修改属性和数组项并不受影响。<br><code>let</code> 用法相当与<code>var</code>，只是<code>let</code>只在块级作用域起作用，不存在变量提升。在项目中，尽量不要使用<code>var</code>。用<code>let</code>和<code>const</code>就足够了。</p>
<h3 id="解构"><a href="#解构" class="headerlink" title="解构"></a>解构</h3><blockquote>
<p>ES6 允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为解构</p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">// 变量赋值可以写成解构形式</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>foo<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>bar<span class="token punctuation">]</span><span class="token punctuation">,</span> baz<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
foo<span class="token punctuation">;</span> <span class="token comment">// 1</span>
bar<span class="token punctuation">;</span> <span class="token comment">// 2</span>
baz<span class="token punctuation">;</span> <span class="token comment">// 3</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> third<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
third<span class="token punctuation">;</span> <span class="token comment">// "baz"</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">// 1</span>
y<span class="token punctuation">;</span> <span class="token comment">// 3</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>head<span class="token punctuation">,</span> <span class="token operator">...</span>tail<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
head<span class="token punctuation">;</span> <span class="token comment">// 1</span>
tail<span class="token punctuation">;</span> <span class="token comment">// [2, 3, 4]</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">...</span>z<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">// "a"</span>
y<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
z<span class="token punctuation">;</span> <span class="token comment">// []</span>

<span class="token comment">// 解构不仅可以用于数组，还可以用于对象</span>
<span class="token keyword">let</span> <span class="token punctuation">&#123;</span> bar<span class="token punctuation">,</span> foo <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> foo<span class="token operator">:</span> <span class="token string">'aaa'</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">'bbb'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
foo<span class="token punctuation">;</span> <span class="token comment">// "aaa"</span>
bar<span class="token punctuation">;</span> <span class="token comment">// "bbb"</span>

<span class="token keyword">let</span> <span class="token punctuation">&#123;</span> baz <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> foo<span class="token operator">:</span> <span class="token string">'aaa'</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">'bbb'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
baz<span class="token punctuation">;</span> <span class="token comment">// undefined</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>项目中，会频繁的用到解构赋值，所以这个非常重要，需要理解解构的语法。</p>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><blockquote>
<p>ES6 允许使用“箭头”（=&gt;）定义函数。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> v<span class="token punctuation">;</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> v<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>值得一提的是，项目中，涉及到 <code>class</code> 组件时，会有 <code>this</code> 指针的问题，所以能用箭头函数，<strong>尽量用箭头函数定义函数</strong>。</p>
<h3 id="对象的拓展"><a href="#对象的拓展" class="headerlink" title="对象的拓展"></a>对象的拓展</h3><blockquote>
<p>ES6 允许直接写入变量和函数，作为对象的属性和方法。这样的书写更加简洁。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">'bar'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> baz <span class="token operator">=</span> <span class="token punctuation">&#123;</span> foo <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
baz<span class="token punctuation">;</span> <span class="token comment">// &#123;foo: "bar"&#125;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">const</span> baz <span class="token operator">=</span> <span class="token punctuation">&#123;</span> foo<span class="token operator">:</span> foo <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里对象的拓展用法，在项目用的比较普遍。</p>
<h3 id="Promise-对象"><a href="#Promise-对象" class="headerlink" title="Promise 对象"></a>Promise 对象</h3><blockquote>
<p>Promise 是异步编程的一种解决方案，比传统的解决方案（回调函数和事件）更合理和更强大。 Promise，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。从语法上说，Promise 是一个对象，从它可以获取异步操作的消息。Promise 提供统一的 API，各种异步操作都可以用同样的方法进行处理。 Promise 对象有以下两个特点。（1）对象的状态不受外界影响。Promise 对象代表一个异步操作，有三种状态：pending（进行中）、fulfilled（已成功）和 rejected（已失败）。只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是 Promise 这个名字的由来，它的英语意思就是“承诺”，表示其他手段无法改变。（2）一旦状态改变，就不会再变，任何时候都可以得到这个结果。Promise 对象的状态改变，只有两种可能：从 pending 变为 fulfilled 和从 pending 变为 rejected。只要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果，这时就称为 resolved（已定型）。如果改变已经发生了，你再对 Promise 对象添加回调函数，也会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了它，再去监听，是得不到结果的。 Promise 对象是一个构造函数，用来生成 Promise 实例。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 创建一个Promise函数</span>
<span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ... some code</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token comment">/* 异步操作成功 */</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 可以用then方法分别指定resolved状态和rejected状态的回调函数。</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// resolve(value);</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// reject(error);</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>项目大量用到这个，就是 fetch 请求了。</p>
<h3 id="async-await"><a href="#async-await" class="headerlink" title="async / await"></a>async / await</h3><blockquote>
<p>ES2017 标准引入了 async 函数，使得异步操作变得更加方便，它就是 Generator 函数的语法糖。 async 函数的返回值是 Promise 对象，这比 Generator 函数的返回值是 Iterator 对象方便多了。你可以用 then 方法指定下一步的操作。async 函数完全可以看作多个异步操作，包装成的一个 Promise 对象，而 await 命令就是内部 then 命令的语法糖。</p>
</blockquote>
<p>这是一种异步转同步的方案，我们项目中可能需要留意的是，Generator 函数，在 dva 定义的 modal 中，<code>yield</code> 关键词的作用，就类似这里的异步转同步。</p>
<h3 id="Class-的语法"><a href="#Class-的语法" class="headerlink" title="Class 的语法"></a>Class 的语法</h3><blockquote>
<p>ES6 提供了更接近传统语言的写法，引入了 Class（类）这个概念，作为对象的模板。通过 class 关键字，可以定义类。ES6 的 class 可以看作只是一个语法糖，它的绝大部分功能，ES5 都可以做到，新的 class 写法只是让对象原型的写法更加清晰、更像面向对象编程的语法而已。</p>
</blockquote>
<p>概念类比 java 中的 <code>class</code>，这里我们可能更需要关注的是 React 类组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>page<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Page<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里定义的 Page 类，继承自 React 的 Component。拥有 React 组件提供的各种钩子。</p>
<h3 id="Module-的语法"><a href="#Module-的语法" class="headerlink" title="Module 的语法"></a>Module 的语法</h3><blockquote>
<p>ES6 模块的设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。模块功能主要由两个命令构成：export 和 import。export 命令用于规定模块的对外接口，import 命令用于输入其他模块提供的功能。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// a.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> appName <span class="token operator">=</span> <span class="token string">'Fz\'Blog'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">const</span> SystemName <span class="token operator">=</span> <span class="token string">'cloud-blog'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>使用 <code>export</code> 命令定义了模块的对外接口以后，其他 JS 文件就可以通过<code>import</code>命令加载这个模块。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> appName <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./a.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> SystemName <span class="token keyword">from</span> <span class="token string">'./a.js'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>更多详细的内容可以看这个——<a target="_blank" rel="noopener" href="https://es6.ruanyifeng.com/">ECMAScript 6 入门教程</a></p>
<hr>
<h2 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h2><p><code>typescript</code> 面对 <code>javascript</code> 有什么优势？为什么选择前者，比较下两者的不同。</p>
<blockquote>
<p>Typescript 是 Javascript 的超集。（Typescript = Type + Javascript）</p>
</blockquote>
<p>更加详细的文档，可以<a target="_blank" rel="noopener" href="https://ts.xcatliu.com/introduction/what-is-typescript">查看这里</a> 在线示例可以<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play/">查看这里</a></p>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><p>前面提到了，<code>Typescript</code> 就是在 <code>Javascript</code> 加了一层<strong>type</strong>。 大家对 java 比较熟悉，java 是一个典型的强类型语言，任何变量都需要有自己的类型声明，但是 <code>Javascript</code> 却是一个弱类型语言。 一个 <code>number</code> 类型的变量可以被赋值为 <code>string</code> 类型，这就带来了诸多的麻烦。<br><code>Typescript</code> 就是解决类型匹配很好的方案。我们可以看下面一段 java 代码和 typescript 代码。</p>
<p>Java：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">"我是字符串"</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">"biubiu"</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token string">"喵喵喵～"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>TypeScript:</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> str<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'我是字符串'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'biubiu'</span><span class="token punctuation">;</span>

  <span class="token comment">// ? 表示该属性可能不存在 即 undefined</span>
  age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token function">cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">'喵喵喵～'</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>类型声明时，<code>Typescript</code> 与 <code>Java</code> 刚好相反，<code>Java</code> 的类型定义在变量前，<code>Typescript</code> 的类型定义在变量后。</p>
<h3 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h3><p>Java =&gt; Typescript<br>Java: Float, Integer, Double ==&gt; Typescript：number<br>Java: String ==&gt; Typescript: string<br>Java: Boolean ==&gt; Typescript: boolean</p>
<p>示例：<br>Java：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">boolean</span> userMan <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> userAge <span class="token operator">=</span> <span class="token number">81</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> userAverage <span class="token operator">=</span> <span class="token number">10.5</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> userName <span class="token operator">=</span> <span class="token string">"桐人"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>Typescript：</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">let</span> userMan<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userAge<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">81</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userAverage<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">10.5</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userName<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'桐人'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="任意值"><a href="#任意值" class="headerlink" title="任意值"></a>任意值</h3><blockquote>
<p>由于前端数据来源比较广而脆弱，对数据类型的灵活性要求也比较高，Typescript 发明了 any 类型，来应对各种类型不匹配的 edge case，快速解决类型问题无法编译通过的问题。</p>
</blockquote>
<p>在不清楚数据类型时，可以用<code>any</code>来定义。不过不建议大量使用。不然使用 <code>typescript</code> 就没有什么意义了。</p>
<h3 id="复合类型"><a href="#复合类型" class="headerlink" title="复合类型"></a>复合类型</h3><p>enum 语法比较一致</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// Java</span>
<span class="token keyword">enum</span> WeekDayEnum <span class="token punctuation">&#123;</span>
  Mon<span class="token punctuation">,</span>
  Tue<span class="token punctuation">,</span>
  Wed<span class="token punctuation">,</span>
  Thu<span class="token punctuation">,</span>
  Fri<span class="token punctuation">,</span>
  Sat<span class="token punctuation">,</span>
  Sun<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// Typescript</span>
<span class="token keyword">enum</span> WeekDayEnum <span class="token punctuation">&#123;</span>
  Mon<span class="token punctuation">,</span>
  Tue<span class="token punctuation">,</span>
  Wed<span class="token punctuation">,</span>
  Thu<span class="token punctuation">,</span>
  Fri<span class="token punctuation">,</span>
  Sat<span class="token punctuation">,</span>
  Sun<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 附上初始值：</span>
<span class="token keyword">enum</span> WeekDayEnum <span class="token punctuation">&#123;</span>
  Mon <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  Tue <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
  Wed <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
  Thu <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
  Fri <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
  Sat <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>
  Sun <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="interface、type-和-class"><a href="#interface、type-和-class" class="headerlink" title="interface、type 和 class"></a>interface、type 和 class</h3><p><code>interface</code>接口，类比 java 中的 interface，接口是一系列抽象方法的声明，是一些方法特征的集合，这些方法都应该是抽象的，需要由具体的类去实现，然后第三方就可以通过这组抽象方法调用，让具体的类执行具体的方法。 <code>type</code> 用来定义数据结构。 <code>class</code> 类比 java，有私有和静态属性，可以继承，构造方法……</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
    firstName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>
    lastName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token function-variable function">sayHi</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token builtin">string</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">type</span> <span class="token class-name">User</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>三者都可以用来定义数据结构，但是意义不同，使用场景也不同。</p>
<p>由于 typescript 的宗旨是兼容 js，运行时要擦除所有类型信息，因此<code>interface</code>和<code>type</code>在运行时是会被完全消除的。而<code>class</code>经过编译后，在运行时依然存在。因此如果要声明的类型只是纯粹的类型信息，只需要声明<code>interface</code>即可。</p>
<h3 id="类型推导"><a href="#类型推导" class="headerlink" title="类型推导"></a>类型推导</h3><blockquote>
<p>Typescript 能够在静态分析中推导出类型，不需要像 Java 那样处处定义。这也是 Typescript 把类型定义放在变量后，而 Java 把类型定义放在变量前的原因。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 对于这里的变量，typescript可以通过赋值获取变量的类型，和上面的定义效果是相同的</span>
<span class="token keyword">let</span> userMan <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userAge <span class="token operator">=</span> <span class="token number">81</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userAverage <span class="token operator">=</span> <span class="token number">10.5</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userName <span class="token operator">=</span> <span class="token string">'桐人'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h3><p>上面例子中已经有函数的例子了，java 在定义时，返回值以参数类型都需要写。并且写在变量之前。而 typescript 则是之后。看下面的例子 🌰：</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> <span class="token function-variable function">multiply</span><span class="token operator">:</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function-variable function">number</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">*</span> b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h3><ul>
<li>.ts Typescript 文件</li>
<li>.tsx Typescript + JSX，支持 JSX 语法</li>
<li>.d.ts 相当于 C++ .h 文件，只有类型声明，没有实现代码。</li>
</ul>
<p>更多的内容可以查看<a target="_blank" rel="noopener" href="https://www.tslang.cn/docs/handbook/basic-types.html">官方文档</a></p>
<hr>
<h2 id="React-js"><a href="#React-js" class="headerlink" title="React.js"></a>React.js</h2><p>什么是 react.js? 为什么选择 react.js？</p>
<blockquote>
<p>React 使创建交互式 UI 变得轻而易举。为你应用的每一个状态设计简洁的视图，当数据改变时 React 能有效地更新并正确地渲染组件。创建拥有各自状态的组件，再由这些组件构成更加复杂的 UI。组件逻辑使用 JavaScript 编写而非模版，因此你可以轻松地在应用中传递数据，并使得状态与 DOM 分离。一个通过 react 框架构成的前端应用，其构成结构为：元素 -&gt; 组件 -&gt; 模块 -&gt; 页面 -&gt; 站点； <strong>牢记重点：状态、组件、单向数据流。</strong></p>
</blockquote>
<p><code>React.js</code> 是一个帮助你构建页面 UI 的库。如果你熟悉 MVC 概念的话，那么 React 的组件就相当于 MVC 里面的 View。如果你不熟悉也没关系，你可以简单地理解为，<code>React.js</code> 将帮助我们将界面分成了各个独立的小块，每一个块就是组件，这些组件之间可以组合、嵌套，就成了我们的页面。一个组件的显示形态和行为有可能是由某些数据决定的。而数据是可能发生改变的，这时候组件的显示形态就会发生相应的改变。而 <code>React.js</code> 也提供了一种非常高效的方式帮助我们做到了数据和组件显示形态之间的同步。 <code>React.js</code> 不是一个框架，它只是一个库。<strong>它只提供 UI （view）层面的解决方案</strong>。在实际的项目当中，它并不能解决我们所有的问题，需要结合其它的库，例如 <code>Redux</code>、<code>React-router</code> 等来协助提供完整的解决方法。</p>
<p>一个小 <code>Demo</code> 帮你理解 react 在做什么？</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>What's Reactjs?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>screen<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
      <span class="token selector">.like-btn</span> <span class="token punctuation">&#123;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">/* Component */</span>
    <span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props <span class="token operator">=</span> props<span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">const</span> oldEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>onStateChange<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onStateChange</span><span class="token punctuation">(</span>oldEl<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      <span class="token function">renderDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> <span class="token function">createDOMFromString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClick<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">createDOMFromString</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">domString</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> domString<span class="token punctuation">;</span>
      <span class="token keyword">return</span> div<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">mount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">component<span class="token punctuation">,</span> wrapper</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span><span class="token function">renderDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      component<span class="token punctuation">.</span><span class="token function-variable function">onStateChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">oldEl<span class="token punctuation">,</span> newEl</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>newEl<span class="token punctuation">,</span> oldEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>oldEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">/* ========================================= */</span>
    <span class="token keyword">class</span> <span class="token class-name">LikeButton</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span> isLiked<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
          isLiked<span class="token operator">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isLiked<span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
          &lt;button class='like-btn' style="background-color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>bgColor<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">">
            &lt;span class='like-text'>
              </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isLiked <span class="token operator">?</span> <span class="token string">'取消'</span> <span class="token operator">:</span> <span class="token string">'点赞'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
            &lt;/span>
            &lt;span>👍&lt;/span>
          &lt;/button>
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">class</span> <span class="token class-name">RedBlueButton</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
          color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
          color<span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
          &lt;div style='color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;'></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/div>
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.wrapper'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">mount</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LikeButton</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> bgColor<span class="token operator">:</span> <span class="token string">'red'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">mount</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LikeButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">mount</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RedBlueButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>更详细的理解 React.js 可以查看<a target="_blank" rel="noopener" href="http://fangzhioooo.gitee.io/">这里</a>;</strong></p>
<h3 id="jsx"><a href="#jsx" class="headerlink" title="jsx"></a>jsx</h3><p>这种看起来“在 JavaScript 写的标签的”语法叫 JSX。但注意的是，在写组件的时候，需要引入 react。</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Hello World</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Page</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>想了解更多可以查看<a target="_blank" rel="noopener" href="http://fangzhioooo.gitee.io/">jsx 的原理</a></p>
<p>从 jsx 到页面的过程，大致如下：</p>
<p><img src="https://images.gitee.com/uploads/images/2020/0525/162108_2554daa9_2106937.png" alt="jsx编译过程"></p>
<p>所以为啥不可以直接从 jsx 直接解析为 dom，而是先解析为 js 对象后，再经过<code>react-dom</code>，解析为 dom？第一点，在于可以复用结构，我们不一定仅仅渲染成 dom，也可以去渲染成其他的结构。比如，想象有个<code>react-dingding</code>，那我们也可以把这个 js 对象解析成钉钉小程序需要的页面？<br>第二点，在于方便做 diff 算法。</p>
<p>总结：</p>
<ol>
<li>JSX 是 JavaScript 语言的一种语法扩展，长得像 HTML，但并不是 HTML。</li>
<li>React.js 可以用 JSX 来描述你的组件长什么样的。</li>
<li>JSX 在编译的时候会变成相应的 JavaScript 对象描述。</li>
<li>react-dom 负责把这个用来描述 UI 信息的 JavaScript 对象变成 DOM 元素，并且渲染到页面上。</li>
</ol>
<h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p>React.js 中一切皆组件，用 React.js 写的其实就是 React.js 组件。我们在编写 React.js 组件的时候，一般都需要继承 React.js 的 <code>Component</code>。一个组件类必须要实现一个 render 方法，这个 render 方法必须要返回一个 JSX 元素。并且不能并排返回多个元素，只能包裹在一个元素中。若有返回多个的需求，React.js 提供<code>Fragment</code>标签，可以实现。</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">class</span> <span class="token class-name">Header</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    title<span class="token operator">:</span> <span class="token string">'详情'</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">首页 / </span><span class="token punctuation">&#123;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>title <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">renderContent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">我是一篇文章！</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">我是标题</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> divClass <span class="token operator">=</span> <span class="token string">'page-wapper'</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> isSuccess <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span>divClass<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
		</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Header</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>xx详情<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
		</span><span class="token punctuation">&#123;</span> title <span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"> 1 + 2 = </span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
		</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">&#123;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
		</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">&#123;</span> isSuccess<span class="token operator">===</span><span class="token boolean">true</span> <span class="token operator">?</span> <span class="token string">'成功'</span> <span class="token operator">:</span> <span class="token string">'失败'</span>  <span class="token punctuation">&#125;</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>组件中，可以定义 jsx 变量，组件之间也是可以嵌套、组合的。 <code>&#123;&#125;</code>内可以放任何 JavaScript 的代码，包括变量、表达式计算、函数执行等等。<br>render 会把这些代码返回的内容如实地渲染到页面上，非常的灵活。 ⚠️ 注意这里的类名，用的是<code>className</code>，因为<code>class</code>是 js 的关键字，类似的比如<code>htmlFor</code>用来替代<code>label</code>的<code>for</code>属性。</p>
<h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><p>组件是相互独立、可复用的单元，一个组件可能在不同地方被用到。但是在不同的场景下对这个组件的需求可能会根据情况有所不同。React.js 的 props 就可以帮助我们达到这个效果。 ⚠️ 注意无法在组件内修改组件的 props。只能是父组件修改 props，传入子组件触发更新。</p>
<p>那么怎么把 props 传进去呢？在使用一个组件的时候，可以把参数放在标签的属性当中，所有的属性都会作为 props 对象的键值。比如上面的<code>&lt;Header /&gt;</code> 传入的参数<code>title</code>。</p>
<p>总结：</p>
<ol>
<li>为了使得组件的可定制性更强，在使用组件的时候，可以在标签上加属性来传入配置参数。</li>
<li>组件可以在内部通过 this.props 获取到配置参数，组件可以根据 props 的不同来确定自己的显示形态，达到可配置的效果。</li>
<li>可以通过给组件添加类属性 defaultProps 来配置默认参数。</li>
<li>props 一旦传入，你就不可以在组件内部对它进行修改。但是你可以通过父组件主动重新渲染的方式来传入新的 props，从而达到更新的效果。</li>
</ol>
<h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>一个组件的显示形态是可以由它数据状态<code>state</code>和配置参数<code>props</code>决定的。一个组件可以拥有自己的状态<code>state</code>。但是状态不能直接赋值修改，只能通过<code>setState</code>进行修改。</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleBtnClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      count<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">当前数量：</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">&#125;</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleBtnClick<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">加一</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p>可以为 class 组件声明一些特殊的方法，当组件挂载或更新或卸载时就会去执行这些方法，称为组件生命周期方法。当组件实例被创建并插入 DOM 中时，其生命周期调用顺序如下： • <code>constructor()</code> • <code>static getDerivedStateFromProps()</code> • <code>render()</code> • <code>componentDidMount()</code> 当组件的 props 或 state 发生变化时会触发更新。组件更新的生命周期调用顺序如下： • <code>static getDerivedStateFromProps()</code> • <code>shouldComponentUpdate()</code> • <code>render()</code> • <code>getSnapshotBeforeUpdate()</code> • <code>componentDidUpdate()</code> 当组件从 DOM 中移除时会调用如下方法： • <code>componentWillUnmount()</code> 当渲染过程，生命周期，或子组件的构造函数中抛出错误时，会调用如下方法： • <code>static getDerivedStateFromError()</code> • <code>componentDidCatch()</code></p>
<p>⚠️ 注意，这里的生命周期指的是，React@17+版本，对比之前版本，删去了<code>componentWillMount</code>, <code>componentWillReceiveProps</code>和<code>componentWillUpdate</code>三个生命钩子。</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2019/png/5144/1556372331485-d7c09d5c-a9fa-4301-9d36-8a7f7cfef7e6.png?x-oss-process=image/resize,w_746" alt="react 生命周期"></p>
<h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><p>在 React.js 里面监听事件是很容易的事情，你只需要给需要监听事件的元素加上属性类似于 <code>onClick</code>、<code>onKeyDown</code> 这样的属性。建议在书写监听函数时，也使用驼峰式写法。参考上面的例子。</p>
<p>⚠️ 注意，上面的例子<code>handleBtnClick</code>使用的是箭头函数。是因为其中使用了<code>this</code>指针，只有使用箭头函数，才能保证函数内部的<code>this</code>指向这个组件。如果不使用箭头函数，则需要使用<code>bind</code>来指定<code>this</code>的指向。</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token comment">// 这里使用不是箭头函数，如果未绑定this，内部的this会是 undefined</span>
  <span class="token function">handleBtnClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      count<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">当前数量：</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">&#125;</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleBtnClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">加一</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果需要向事件函数中传递参数，则应该如下写法：</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleBtnClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'param'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">加一</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="列表和-key"><a href="#列表和-key" class="headerlink" title="列表和 key"></a>列表和 key</h3><p>列表数据在前端非常常见，我们经常要处理这种类型的数据，例如文章列表、评论列表、用户列表… React.js 当然也允许我们处理列表数据，但在使用 React.js 处理列表数据的时候，需要掌握一些规则。</p>
<ol>
<li>使用 map 渲染列表数据</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span> username<span class="token operator">:</span> <span class="token string">'Jerry'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span> gender<span class="token operator">:</span> <span class="token string">'male'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> username<span class="token operator">:</span> <span class="token string">'Tomy'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> gender<span class="token operator">:</span> <span class="token string">'male'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> username<span class="token operator">:</span> <span class="token string">'Lily'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span> gender<span class="token operator">:</span> <span class="token string">'female'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> username<span class="token operator">:</span> <span class="token string">'Lucy'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> gender<span class="token operator">:</span> <span class="token string">'female'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span>users<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">姓名：</span><span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span>username<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">年龄：</span><span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span>age<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">性别：</span><span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span>gender<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Index</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以上代码虽然可以正确地渲染出结果，但是打开控制台就发现，报出了很多错误<code>a key should be provided for list items</code>。意思是，列表的每一项，应该设置一个唯一的<code>**key**</code>来标记，这和 diff 算法有关。 React.js 的是非常高效的，它高效依赖于所谓的 Virtual-DOM 策略。简单来说，能复用的话 React.js 就会尽量复用，没有必要的话绝对不碰 DOM。对于列表元素来说也是这样，但是处理列表元素的复用性会有一个问题：元素可能会在一个列表中改变位置。但是如果设置了唯一的 key，那么我们就知道哪些元素改变了，需要重新渲染。 ⚠️ 注意，不要使用<code>index</code>作为元素的 key，尽量是后台返回数据的 id 作为唯一 key。</p>
<h3 id="父组件和子组件通信"><a href="#父组件和子组件通信" class="headerlink" title="父组件和子组件通信"></a>父组件和子组件通信</h3><p><strong>父级组件通过 props 传递与子级组件进行数据&amp;状态的通信，子级组件通过回调函数与父子组件进行通信。</strong></p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
      value<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 父级组件触发回调函数后获取到传递过来的数据，变更 state，重新渲染</span>
  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      value<span class="token operator">:</span> data<span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>value<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Child</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span>value<span class="token punctuation">&#125;</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">&#125;</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 子级组件通过 onChange 回调函数传递数据</span>
<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h1 id="工具和-UI"><a href="#工具和-UI" class="headerlink" title="工具和 UI"></a>工具和 UI</h1><h2 id="Umi-js"><a href="#Umi-js" class="headerlink" title="Umi.js"></a>Umi.js</h2><blockquote>
<p>umi，中文可发音为乌米，是一个可插拔的企业级 react 应用框架。umi 以路由为基础的，支持类 next.js 的约定式路由，以及各种进阶的路由功能，并以此进行功能扩展，比如支持路由级的按需加载。然后配以完善的插件体系，覆盖从源码到构建产物的每个生命周期，支持各种功能扩展和业务需求，目前内外部加起来已有 50+ 的插件。</p>
</blockquote>
<p>为什么使用 umi.js?</p>
<h3 id="✨-特性"><a href="#✨-特性" class="headerlink" title="✨ 特性"></a>✨ 特性</h3><ul>
<li>📦 开箱即用，内置 react、react-router 等</li>
<li>🏈 类 next.js 且功能完备的路由约定，同时支持配置的路由方式</li>
<li>🎉 完善的插件体系，覆盖从源码到构建产物的每个生命周期</li>
<li>🚀 高性能，通过插件支持 PWA、以路由为单元的 code splitting 等</li>
<li>💈 支持静态页面导出，适配各种环境，比如中台业务、无线业务、egg、支付宝钱包、云凤蝶等</li>
<li>🚄 开发启动快，支持一键开启 dll 等</li>
<li>🐠 一键兼容到 IE9，基于 umi-plugin-polyfills</li>
<li>🍁 完善的 TypeScript 支持，包括 d.ts 定义和 umi test</li>
<li>🌴 与 dva 数据流的深入融合，支持 duck directory、model 的自动加载、code splitting 等等</li>
</ul>
<p>关于 roadhog 与 umi.js 的关系？</p>
<blockquote>
<p>roadhog 是基于 webpack 的封装工具，目的是简化 webpack 的配置。 umi 可以简单地理解为 roadhog + 路由，思路类似<code>next.js/nuxt.js</code>，辅以一套插件机制，目的是通过框架的方式简化 React 开发。</p>
</blockquote>
<p>umi 架构图</p>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/zvfEXesXdgTzWYZCuHLe.png" alt="umi架构图"></p>
<p>构建流程图</p>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/NKsqmTAttwTzYVMJMcnB.png" alt="umi生命周期"></p>
<p>在下面，我们会详细讲到从零搭建一个 umi 的应用。</p>
<p>这里是<a target="_blank" rel="noopener" href="https://umijs.org/zh/guide/">官方文档</a>，使用中，我们更多的关注是 <a target="_blank" rel="noopener" href="https://umijs.org/zh/config/">配置</a></p>
<p>DT 前端推行使用的工程化解决方案——<a target="_blank" rel="noopener" href="https://prijs.github.io/pri-docs/usage/">pri</a>。其发自 umi.js</p>
<h2 id="Dva"><a href="#Dva" class="headerlink" title="Dva"></a>Dva</h2><blockquote>
<p>dva 首先是一个基于 redux 和 redux-saga 的数据流方案，然后为了简化开发体验，dva 还额外内置了 react-router 和 fetch，所以也可以理解为一个轻量级的应用框架。</p>
</blockquote>
<p>dva 就是一种 react 状态管理的解决方案，关于 redux，你可以查看下面的参考文档学习更多。这里简单介绍下。</p>
<p>• <a target="_blank" rel="noopener" href="https://www.redux.org.cn/">官方文档</a></p>
<p>最常见的 Web 类示例之一: TodoList = Todo list + Add todo button</p>
<p>react 正常写法：</p>
<p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436560812-2586a0b5-7a6a-4a07-895c-f822fa85d5de.png" alt="react"></p>
<p>redux 的工作流程：</p>
<p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436134375-4c15f63d-72f1-4c73-94a6-55b220d2547c.png" alt="redux.gif"></p>
<p>redux-saga 的结构：</p>
<p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436167824-7fa834ea-aa6c-4f9f-bab5-b8c5312bcf7e.png" alt="redux-saga"></p>
<p>dva 流程：</p>
<p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436195004-cd3800f2-f13d-40ba-bb1f-4efba99cfe0d.png" alt="dva流程图.png"></p>
<p>原作者关于这块的介绍，<a target="_blank" rel="noopener" href="https://www.yuque.com/flying.ni/the-tower/tvzasn">请查看</a>。</p>
<h2 id="Ant-Design"><a href="#Ant-Design" class="headerlink" title="Ant Design"></a>Ant Design</h2><blockquote>
<p>antd 是基于 Ant Design 设计体系的 React UI 组件库，主要用于研发企业级中后台产品。</p>
</blockquote>
<p>为啥用 Ant Design？</p>
<h3 id="✨-特性-1"><a href="#✨-特性-1" class="headerlink" title="✨ 特性"></a>✨ 特性</h3><ul>
<li>🌈 提炼自企业级中后台产品的交互语言和视觉风格。</li>
<li>📦 开箱即用的高质量 React 组件。</li>
<li>🛡 使用 TypeScript 开发，提供完整的类型定义文件。</li>
<li>⚙️ 全链路开发和设计工具体系。</li>
<li>🌍 数十个国际化语言支持。</li>
<li>🎨 深入每个细节的主题定制能力。</li>
</ul>
<p>这里 UI 组件，在项目中会大量用到，具体的用法可以查看<a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/button-cn/">组件库</a>，有详细的使用 Demo 和文档说明。</p>
<p>⚠️ 这里主要说明的是，目前项目用的 Ant 版本是 4.0+ 。而之前项目中使用的一直是 3+版本。 在 4+版本中，更改了许多的 Api。涉及常用的组件有：图标（Icon）、表单（Form）等。如果你之前有使用过 Ant@3+版本，在使用时，需要留意 Api 的改变。这里推荐使用新的 4+版本，因为解决了许多之前版本的问题，如，icon 加载导致打包文件体积过大。具体详情查看<a target="_blank" rel="noopener" href="https://ant-design.gitee.io/docs/react/migration-v4-cn">从 v3 到 v4</a>。</p>
<h2 id="Pont"><a href="#Pont" class="headerlink" title="Pont"></a>Pont</h2><blockquote>
<p>pont 在法语中是“桥”的意思，寓意着前后端之间的桥梁 Pont 把 swagger、rap、dip 等多种接口文档平台，转换成 Pont 元数据。Pont 利用接口元数据，可以高度定制化生成前端接口层代码，接口 mock 平台和接口测试平台。</p>
</blockquote>
<p>关于 pont 更多的信息，可以查看<a target="_blank" rel="noopener" href="https://github.com/alibaba/pont">官方文档</a></p>
<p><img src="https://camo.githubusercontent.com/bbb2dc0083048244d9ab8bf651a31082630f99c4dd2134d20c6c08fd8414009b/68747470733a2f2f696d672e616c6963646e2e636f6d2f7466732f54423135705a47493654704b31526a535a4b5058586133557058612d313538342d313039302e706e67" alt="pont.png"></p>
<h1 id="开发和发布"><a href="#开发和发布" class="headerlink" title="开发和发布"></a>开发和发布</h1><h2 id="从零开始构建项目"><a href="#从零开始构建项目" class="headerlink" title="从零开始构建项目"></a>从零开始构建项目</h2><p>现有的 OneData 系列的三个产品，均采用的前端也是目前这一套技术栈；接下来，我们从零开始搭建一个前端项目，以 <code>OneData</code> 为基础。</p>
<h3 id="使用-create-umi-脚手架创建基础项目"><a href="#使用-create-umi-脚手架创建基础项目" class="headerlink" title="使用 create-umi 脚手架创建基础项目"></a>使用 create-umi 脚手架创建基础项目</h3><p>可以参看<a target="_blank" rel="noopener" href="https://umijs.org/zh/guide/create-umi-app.html">官方文档</a>,</p>
<blockquote>
<p>你可以通过 <code>yarn create umi</code> 或 <code>npm create umi</code> 使用 <code>create-umi</code>。推荐使用 <code>yarn create</code> 命令，能确保每次使用最新的脚手架。</p>
</blockquote>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">$ yarn create umi
$ ...
$ ...
$ curl --compressed -o- -L https:&#x2F;&#x2F;yarnpkg.com&#x2F;install.sh | bash
success Installed &quot;create-umi@0.21.2&quot; with binaries:
      - create-umi
? Select the boilerplate type ant-design-pro
? 🤓 Which language do you want to use? TypeScript
? 🚀 Do you need all the blocks or a simple scaffold? simple
? 🦄 Time to use better, faster and latest antd@4! Yes
Cloning into &#39;&#x2F;Users&#x2F;fz&#x2F;Desktop&#x2F;Project&#x2F;onedefine&#x2F;onedefine-ts&#39;...
remote: Enumerating objects: 189, done.
remote: Counting objects: 100% (189&#x2F;189), done.
remote: Compressing objects: 100% (174&#x2F;174), done.
remote: Total 189 (delta 21), reused 67 (delta 8), pack-reused 0
Receiving objects: 100% (189&#x2F;189), 297.17 KiB | 31.00 KiB&#x2F;s, done.
Resolving deltas: 100% (21&#x2F;21), done.
&gt; 🚚 clone success
&gt; Clean up...
✨ File Generate Done
✨  Done in 196.52s.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>⚠️ 注意这里选择选项， 选择 <em>ant-design-pro</em> 、_TypeScript_、<em>simple</em>和<em>Yes</em>，主要是选择使用 Typescript 和使用 antd@4 以上版本。</p>
<p>这是创建的文件结构如下：</p>
<pre class="line-numbers language-none"><code class="language-none">root
├── config                                      # umi 配置，包含路由，构建等配置
├── dist                                        # 构建项目目标位置 build后创建
├── public                                      # 公共静态资源 如favicon
├── src
│   ├── components                              # 业务通用组件
│   ├── layouts                                 # 通用布局
│   ├── locales                                 # 国际化资源
│   ├── models                                  # 全局 dva model
│   │   ├── ....                                    # 所有的model定义
│   │   └── global.ts                               # 全局属性相关 如，导航展开控制
│   ├── pages                                   # 业务页面入口和常用模板
│   │   ├── ...                                     # 各种页面
│   │   ├── 404.tsx                                  # 404页面
│   │   └── document.ejs                            # index.html
│   ├── services                                # 后台接口服务 自定义的接口请求
│   ├── pont                                    # 后台接口服务以及BO pont接口自动化生成接口
│   ├── utils                                   # 工具库
│   │   ├── request.ts                              # 请求方法函数 基于umi-request&#x2F;fetch
│   │   ├── utils.ts                                # 工具类函数
│   │   ├── utils.less                              # 工具类样式
│   │   └── utils.test.ts                          # 工具类函数测试方法
│   ├── global.less                             # 全局样式
│   ├── global.tsx                              # 全局JS 主要是serviceWorker相关配置
│   └── typings.d.ts                            # ts声明文件
├── tests                                       # 测试工具
├── README.md
├── pont-config.json                                # pont的配置文件
└── package.json                                    # npm配置文件
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>继续修改下项目，删除不需要的模块，如用户登陆界面、权限路由控制等。</p>
<h3 id="接入接口层自动生成工具-pont"><a href="#接入接口层自动生成工具-pont" class="headerlink" title="接入接口层自动生成工具 pont"></a>接入接口层自动生成工具 pont</h3><p><strong>这里需要后端提供的接口尽量标准（openapi），关于 api 文档，官方推荐 swagger2+版本，请求方法明确；虽然理论上可以实现 RESTful 风格的接口，但是暂时不太好实践 ，后端暂时不要使用。</strong></p>
<ol>
<li>在根目录下添加<code>pont-config.json</code>和其中指定的<code>templatePath</code>文件<code>pontTemplate.ts</code>.</li>
</ol>
<p>别忘了在 global.tsx 中添加</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">'@/pont'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>pont-config.json</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">"./src/pont"</span><span class="token punctuation">,</span>
  <span class="token property">"originUrl"</span><span class="token operator">:</span> <span class="token string">"http://localhost:7001/v2/api-docs"</span><span class="token punctuation">,</span>
  <span class="token property">"templatePath"</span><span class="token operator">:</span> <span class="token string">"./pontTemplate"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>pontTemplate.ts</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> CodeGenerator<span class="token punctuation">,</span> Interface <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'pont-engine'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyGenerator</span> <span class="token keyword">extends</span> <span class="token class-name">CodeGenerator</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getInterfaceContentInDeclaration</span><span class="token punctuation">(</span><span class="token parameter">inter<span class="token operator">:</span> Interface</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> paramsCode <span class="token operator">=</span> inter<span class="token punctuation">.</span><span class="token function">getParamsCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> bodyParamsCode <span class="token operator">=</span> inter<span class="token punctuation">.</span><span class="token function">getBodyParamsCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> hasGetParams <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>inter<span class="token punctuation">.</span>parameters<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span> <span class="token operator">=></span> param<span class="token punctuation">.</span>in <span class="token operator">!==</span> <span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">const</span> requestParams <span class="token operator">=</span> bodyParamsCode
      <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>hasGetParams <span class="token operator">?</span> <span class="token string">'params, '</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">data &#125;:&#123; params</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>
          hasGetParams <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> <span class="token string">'?'</span>
        <span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">: Params, data: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>bodyParamsCode<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;</span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>hasGetParams <span class="token operator">?</span> <span class="token string">'params'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;:&#123; params</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>hasGetParams <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> <span class="token string">'?'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">: Params &#125;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      export </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>paramsCode<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">

      export type Response = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>inter<span class="token punctuation">.</span>responseType<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">

      export const init: Response;

      export function request(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>requestParams<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">): Promise&lt;Response>;

      </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">getInterfaceContent</span><span class="token punctuation">(</span><span class="token parameter">inter<span class="token operator">:</span> Interface</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> paramsCode <span class="token operator">=</span> inter<span class="token punctuation">.</span><span class="token function">getParamsCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> bodyParamsCode <span class="token operator">=</span> inter<span class="token punctuation">.</span><span class="token function">getBodyParamsCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> method <span class="token operator">=</span> inter<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> requestParams <span class="token operator">=</span> bodyParamsCode
      <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&#123;params=&#123;&#125;,data&#125;:&#123;params: Params,data: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>bodyParamsCode<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&#125;</span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&#123;params=&#123;&#125;&#125;:&#123;params: Params&#125;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      /**
      * @description </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>inter<span class="token punctuation">.</span>description<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
      */

    import Request from '@/utils/request';
    import * as defs from '../../baseClass';

    export </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>paramsCode<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;

    export const init = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>inter<span class="token punctuation">.</span>response<span class="token punctuation">.</span>initialValue<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;

    export async function request(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>requestParams<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">): Promise&lt;any> &#123;
      return Request('</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>inter<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">',&#123;
        method: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>method<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">',
        params,
        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>bodyParamsCode <span class="token operator">?</span> <span class="token string">'data,'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
      &#125;);
    &#125;

   </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>添加项目对 pont 的支持，这里的<code>pont-engine</code>,需要执行</li>
</ol>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">npm install pont-engine --save-dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>值得注意的是，pontTemplate.ts 中的<code>getInterfaceContent</code>，表示了你该如何调用你的 fetch 以及入参方式，这里我使用的是<code>umi-request</code>,你可以查看<a target="_blank" rel="noopener" href="https://github.com/umijs/umi-request">官方文档</a>,了解 fetch 的详细用法。</p>
<p>目前构建的项目中，派发请求传递参数方法如下：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  type<span class="token operator">:</span> <span class="token string">'global/fetchMicroData'</span><span class="token punctuation">,</span>
  payload<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// query参数放在params中， 如get请求</span>
    params<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token comment">// body参数放在data中， 如post请求</span>
    data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      username<span class="token operator">:</span> <span class="token string">'biubiu'</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>⚠️ 注意 quary 参数和 body 参数传递并不冲突，可以两者同时传递。</p>
<p>这里需要后端配合接入 openapi 接口文档才能使用 pont 自动生成，如这里使用的 swagger，接入后，会在指定的文件夹（我们这里指定的是<code>pont</code>）下生成一个名为<code>api-lock.json</code>的文件，就是用来描述后端<code>接口</code>和<code>BO对象</code>。</p>
<ol start="3">
<li>前端需要配合 vscode 的插件，才能生成对应的 service。生成的 pont 接口文件结构如下：</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">pont
├── mods                            # 自动化生成的接口请求方法
├── api-lock.json                          # 根据swagger文档，生成的pont接口描述文件
├── api.d.ts                               # pont声明文件，描述BO对象和API请求
├── baseClass.ts                           # BO对象结构
└── index.ts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="代理请求"><a href="#代理请求" class="headerlink" title="代理请求"></a>代理请求</h3><p>前端需要连接后端服务调试时，就会遇到跨域等一系列问题。这里介绍下项目中如何解决前后端联调问题的。</p>
<p>目前这里有两个解决方案。</p>
<ol>
<li><p>修改 host<br>访问线上项目，获取到 cookie 后，修改 host，让线上地址指向本地 localhost。<br>如访问 <code>yourdomain.com</code>后，修改 host， 将<code>yourdomain.com</code>指向 <code>localhost</code>.这种方法很麻烦。且需要频繁修改 host。所以一般不这样做。</p>
</li>
<li><p>代理请求在应对这种情况时，前端开发已经有了好的解决方法，通过提供的 umi 插件，实现代理请求。<br>在 <code>config</code> 中，会有一个 <code>proxy.ts</code> 文件，用来定义接口代理的配置。这个功能只在<code>dev</code>环境生效，线上需要自己配置实现，如<code>nginx反向代理</code>。</p>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  dev<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'/commonapi'</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      target<span class="token operator">:</span> <span class="token string">'http://localhost:7001/commonapi'</span><span class="token punctuation">,</span>
      changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      pathRewrite<span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token string">'^/commonapi'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token string">'/serachapi'</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      target<span class="token operator">:</span> <span class="token string">'http://localhost:7001/serachapi'</span><span class="token punctuation">,</span>
      changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      pathRewrite<span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token string">'^/serachapi'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  pre<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'/'</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      target<span class="token operator">:</span> <span class="token string">'http://localhost:7001/'</span><span class="token punctuation">,</span>
      changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      pathRewrite<span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token string">'^'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面是此项目中的配置，正则匹配路由，代理到指定的地址下，这里的配置只添加了<code>/commonapi</code>和<code>/searchapi</code>开头的配置。后续需要，可以再此添加。</p>
<h3 id="创建一个页面"><a href="#创建一个页面" class="headerlink" title="创建一个页面"></a>创建一个页面</h3><p>以 onedefine 为例，添加一个页面。添加<code>数据大盘</code>这个界面；</p>
<ol>
<li><p>在 <code>page</code> 中添加文件夹 <code>dashboard</code>,在其下添加页面<code>index.tsx</code>；</p>
</li>
<li><p>在 <code>config/router.config.ts</code> 中添加上路由配置，并在<code>src/locales</code>中，配置国际化支持；<br>具体添加页面和配置 router 可以查看本次提交</p>
</li>
<li><p>在 <code>models</code> 中新建 <code>dashboard.ts</code> ，作为数据大盘页面的 state；</p>
</li>
<li><p>在 model 中定义需要的前端对象，这里建议不要直接使用 pont 中定义好的对象；用下面这样继承的方式，方便后面调试和更改；命名方式可以将 BO 改为 VO。</p>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 这里定义前端需要使用的VO 如这里的大盘展示需要的数据对象。</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AnalysisVO</span> <span class="token keyword">extends</span> <span class="token class-name">IndexPageCountBO</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="5">
<li>编写 model 模块的<code>effects</code>和<code>reducers</code>。</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span>
effects<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token operator">*</span><span class="token function">fetchDashboardAnalysis</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span>payload<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>call<span class="token punctuation">,</span>put<span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> response<span class="token operator">:</span>CustomWebResult<span class="token operator">&lt;</span>AnalysisVO<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span>commonApiRpc<span class="token punctuation">.</span>getDefineCount<span class="token punctuation">.</span>request<span class="token punctuation">,</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                  type<span class="token operator">:</span> <span class="token string">'SAVE_STATE'</span><span class="token punctuation">,</span>
                  payload<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        analysis<span class="token operator">:</span> response<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">AnalysisVO</span>
                  <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
reducers<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token constant">SAVE_STATE</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
            <span class="token operator">...</span>state<span class="token punctuation">,</span>
            <span class="token operator">...</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="6">
<li><p>在<code>connect.d.ts</code>中,声明 dashboard 的 state 结构；</p>
</li>
<li><p>在页面中用 dva 提供的高阶函数包装页面组件；</p>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> dashboard<span class="token punctuation">,</span> loading <span class="token punctuation">&#125;</span><span class="token operator">:</span> ConnectState</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  analysisData<span class="token operator">:</span> dashboard<span class="token punctuation">.</span>analysis<span class="token punctuation">,</span>
  loading<span class="token operator">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span><span class="token string">'dashboard/fetchDashboardAnalysis'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Analysis<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="8">
<li>页面正确的位置派发请求，并获取数据展示；</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      type<span class="token operator">:</span> <span class="token string">'dashboard/fetchDashboardAnalysis'</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以上就是一个模块从零搭建的过程，这边建议，page 和 model 尽量是一一对应上的。当然其中会有一些如<code>global</code>,<code>common</code>等用来管理全局状态和通用状态的 model。</p>
<h2 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h2><h3 id="如何部署"><a href="#如何部署" class="headerlink" title="如何部署"></a>如何部署</h3><p>对于<code>umi.js</code>的项目而言，项目构建只需要在项目根目录下运行 <code>npm run build</code>，就可以打包构建项目了，会在根目录下生成<code>dist</code>文件夹，如果没有设置按需加载，那么只会打包出 <code>index.html</code>、<code>umi.js</code>和<code>umi.css</code> 三个文件。一般而言，只需要将这些静态资源发布到 web 服务器即可。</p>
<p>因为目前项目使用的是<code>volecity</code>的模版引擎，严格来说，是前后端不分离的写法。在已经提供了<code>index.html</code>的情况，我们只需要向模版页面提供<strong>js</strong>和<strong>css</strong>，并在页面中添加 <code>react 的根节点元素</code>即可。那我们部署的流程如下：</p>
<ol>
<li>前端打包;</li>
<li>将打包好的<code>umi.js</code>和<code>umi.css</code>文件移动到工程静态资源文件夹下;</li>
<li><code>volecity</code>模版中引入 js 和 css;</li>
<li>后端 aone 发布。</li>
</ol>
<p>注意前端需要配置为禁止打包 hash 和使用 hash 路由，如果静态资源未配置，那么建议也不要页面按需加载打包了。<br>当然也有通过配置 <code>config.ts</code>中的<code>base</code>，部署到非根目录，再在<code>controller</code>中，添加对应的路径映射，避免了页面路由和 api 请求冲突。</p>
<h3 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h3><p>目前通过静态资源文件夹名实现版本控制。</p>
<p>前端项目的<code>package.json</code>中，会配置一条命令<code>deploy</code>,当你运行<code>npm run deploy</code>，就会按照版本号作为文件夹名，打包静态资源到类路径下的<code>static</code>文件夹下。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"xxxx"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.2"</span><span class="token punctuation">,</span>
  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"xxx前端项目"</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"umi build"</span><span class="token punctuation">,</span>
    <span class="token property">"deploy"</span><span class="token operator">:</span> <span class="token string">"umi build &amp;&amp; mkdir ../onedefine-start/src/main/resources/static/$&#123;npm_package_version&#125; &amp;&amp;  cp  -r dist/* ../onedefine-start/src/main/resources/static/$&#123;npm_package_version&#125;"</span><span class="token punctuation">,</span>
    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"npm run start:dev"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  ……
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>java 代码如下：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">	<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;front.version&#125;"</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> projectFrontVersion<span class="token punctuation">;</span>
<span class="token comment">/**
    * 首页页面
    **/</span>
   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">root</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
       <span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       mav<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">"projectfrontversion"</span><span class="token punctuation">,</span> projectFrontVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> mav<span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>index.vm</code>如下：</p>
<pre class="line-numbers language-velocity" data-language="velocity"><code class="language-velocity"><span class="token velocity-comment comment">## 判断前端版本</span>
 <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$!projectfrontversion</span><span class="token punctuation">)</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>前端版本获取失败<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
 <span class="token directive"><span class="token keyword">#else</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/<span class="token variable">$!projectfrontversion</span>/umi.css<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/<span class="token variable">$!projectfrontversion</span>/umi.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
 <span class="token directive"><span class="token keyword">#end</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以上部署方法比较死板，需要修改很多文件。按照之前的 def 发布经验，即使不使用 diamond 的情况下，也可以通过配置中心的方式控制版本。这里不多介绍。</p>
<h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ul>
<li><a target="_blank" rel="noopener" href="https://umijs.org/zh/guide/">Umi.js</a></li>
<li><a target="_blank" rel="noopener" href="https://ant.design/docs/react/introduce-cn">Ant Design</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/pont">Pont</a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/getting-started.html">React.js</a></li>
<li><a target="_blank" rel="noopener" href="https://www.tslang.cn/docs/home.html">Typescript</a></li>
<li>…</li>
</ul>

                
                
                    <br />
                    <!-- post-content-ad -->
                    <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-3409699730406381"
                            data-ad-slot="9289016056"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                    <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                

                <br>
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/more/web-more/web-interview/" data-toggle="tooltip" data-placement="top" title="【分享】关于最近在面试中，遇到的一些问题的汇总～">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/more/web-more/debounce-throttle/" data-toggle="tooltip" data-placement="top" title="【拓展】防抖（Debounce）和节流（Throttle）">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!--打赏-->
                
                    <div class="reward">
                        <div class="reward-button">赏 <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="/img/reward/alipay.jpg"><b>支付宝打赏</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="/img/reward/wechat_pay.jpg"><b>微信打赏</b> </span>
                            </span></div>
                        <p class="reward-notice">赞赏一下</p>
                    </div>
                
                <!--打赏-->

                <br>
                <!--分享-->
                
                    <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                    <!--  css & js -->
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!--分享-->
                <br>                       
                
                <!-- require APlayer -->
                
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
                <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script>

                <div class="aplayer"
                    data-id="2297428102"
                    data-server="netease"
                    data-type="playlist"
                    data-fixed="true" >
                </div>
                

                
        
                    
                        <!-- 来必力City版安装代码 --> 
                        <div id="lv-container" data-id="city" data-uid="MTAyMC80Mzg3OC8yMDQxMw==">
                            <script type="text/javascript">
                                (function (d, s) {
                                    var j, e = d.getElementsByTagName(s)[0];
        
                                    if (typeof LivereTower === 'function') { return; }
        
                                    j = d.createElement(s);
                                    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                                    j.async = true;
        
                                    e.parentNode.insertBefore(j, e);
                                })(document, 'script');
                            </script>
                            <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
                        </div>
                        <!-- City版安装代码已完成 -->
                    
            </div>
            
            <!-- Table of Contents -->
            
  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        <!-- toc -->
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">开发环境准备</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#node"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">node</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%AE%89%E8%A3%85-node-js-npm"><span class="toc-nav-number">1.1.1.</span> <span class="toc-nav-text">安装 node.js &#x2F; npm</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#vscode-%E4%BB%A3%E7%A0%81%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">vscode 代码编辑器</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%89%8D%E7%AB%AF%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">前端语言和框架</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ES6"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">ES6</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#const%E3%80%81let-%E5%92%8C-var"><span class="toc-nav-number">2.1.1.</span> <span class="toc-nav-text">const、let 和 var</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E8%A7%A3%E6%9E%84"><span class="toc-nav-number">2.1.2.</span> <span class="toc-nav-text">解构</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0"><span class="toc-nav-number">2.1.3.</span> <span class="toc-nav-text">箭头函数</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8B%93%E5%B1%95"><span class="toc-nav-number">2.1.4.</span> <span class="toc-nav-text">对象的拓展</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Promise-%E5%AF%B9%E8%B1%A1"><span class="toc-nav-number">2.1.5.</span> <span class="toc-nav-text">Promise 对象</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#async-await"><span class="toc-nav-number">2.1.6.</span> <span class="toc-nav-text">async &#x2F; await</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Class-%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-nav-number">2.1.7.</span> <span class="toc-nav-text">Class 的语法</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Module-%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-nav-number">2.1.8.</span> <span class="toc-nav-text">Module 的语法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#TypeScript"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">TypeScript</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-nav-number">2.2.1.</span> <span class="toc-nav-text">基本语法</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="toc-nav-number">2.2.2.</span> <span class="toc-nav-text">基本类型</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%BB%BB%E6%84%8F%E5%80%BC"><span class="toc-nav-number">2.2.3.</span> <span class="toc-nav-text">任意值</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="toc-nav-number">2.2.4.</span> <span class="toc-nav-text">复合类型</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#interface%E3%80%81type-%E5%92%8C-class"><span class="toc-nav-number">2.2.5.</span> <span class="toc-nav-text">interface、type 和 class</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC"><span class="toc-nav-number">2.2.6.</span> <span class="toc-nav-text">类型推导</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="toc-nav-number">2.2.7.</span> <span class="toc-nav-text">函数定义</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-nav-number">2.2.8.</span> <span class="toc-nav-text">文件类型</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#React-js"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">React.js</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#jsx"><span class="toc-nav-number">2.3.1.</span> <span class="toc-nav-text">jsx</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-nav-number">2.3.2.</span> <span class="toc-nav-text">组件</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Props"><span class="toc-nav-number">2.3.3.</span> <span class="toc-nav-text">Props</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#State"><span class="toc-nav-number">2.3.4.</span> <span class="toc-nav-text">State</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-nav-number">2.3.5.</span> <span class="toc-nav-text">生命周期</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-nav-number">2.3.6.</span> <span class="toc-nav-text">事件处理</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%88%97%E8%A1%A8%E5%92%8C-key"><span class="toc-nav-number">2.3.7.</span> <span class="toc-nav-text">列表和 key</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%88%B6%E7%BB%84%E4%BB%B6%E5%92%8C%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-nav-number">2.3.8.</span> <span class="toc-nav-text">父组件和子组件通信</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%B7%A5%E5%85%B7%E5%92%8C-UI"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">工具和 UI</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Umi-js"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">Umi.js</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E2%9C%A8-%E7%89%B9%E6%80%A7"><span class="toc-nav-number">3.1.1.</span> <span class="toc-nav-text">✨ 特性</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Dva"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">Dva</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Ant-Design"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">Ant Design</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E2%9C%A8-%E7%89%B9%E6%80%A7-1"><span class="toc-nav-number">3.3.1.</span> <span class="toc-nav-text">✨ 特性</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Pont"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">Pont</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%BC%80%E5%8F%91%E5%92%8C%E5%8F%91%E5%B8%83"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">开发和发布</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">从零开始构建项目</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%BD%BF%E7%94%A8-create-umi-%E8%84%9A%E6%89%8B%E6%9E%B6%E5%88%9B%E5%BB%BA%E5%9F%BA%E7%A1%80%E9%A1%B9%E7%9B%AE"><span class="toc-nav-number">4.1.1.</span> <span class="toc-nav-text">使用 create-umi 脚手架创建基础项目</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%8E%A5%E5%85%A5%E6%8E%A5%E5%8F%A3%E5%B1%82%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7-pont"><span class="toc-nav-number">4.1.2.</span> <span class="toc-nav-text">接入接口层自动生成工具 pont</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%BB%A3%E7%90%86%E8%AF%B7%E6%B1%82"><span class="toc-nav-number">4.1.3.</span> <span class="toc-nav-text">代理请求</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2"><span class="toc-nav-number">4.1.4.</span> <span class="toc-nav-text">创建一个页面</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%8F%91%E5%B8%83"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">发布</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A6%82%E4%BD%95%E9%83%A8%E7%BD%B2"><span class="toc-nav-number">4.2.1.</span> <span class="toc-nav-text">如何部署</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6"><span class="toc-nav-number">4.2.2.</span> <span class="toc-nav-text">版本控制</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">相关链接</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Recommended Posts  -->
                
                    <hr>
                    <h5>推荐文章</h5>
                    

    <div class="recommended_posts">
        <ul>
            
                <li><a href="https://fangzhioo.github.io/more/web-more/web-interview/">【分享】关于最近在面试中，遇到的一些问题的汇总～</a></li>
            
        </ul>
    </div>
 
                

                <!-- Featured Tags -->
                
                <section>
                    <div class="tags">
                        
                            <a class="tag" href="/tags/#Share" title="Share">Share</a>
                        
                    </div>
                </section>
                
            </div>
        </div>
    </div>
</article>

<!-- 复制添加版权申明-->
<script>
    /**/
    function setClipboardText(event){
        event.preventDefault();//阻止元素发生默认的行为（例如，当点击提交按钮时阻止对表单的提交）。
        var node = document.createElement('div');
        //对documentfragment不熟，不知道怎么获取里面的内容，用了一个比较笨的方式
        node.appendChild(window.getSelection().getRangeAt(0).cloneContents());
        //getRangeAt(0)返回对基于零的数字索引与传递参数匹配的选择对象中的范围的引用。对于连续选择，参数应为零。
        var htmlData = '<div>'
            + node.innerHTML
            + '<br /><br />著作权归作者所有。<br />'
            + '商业转载请联系作者获得授权，非商业转载请注明出处。<br />'
            + '作者：fangzhioo <br />链接：'
            + location.href
            + '<br />来源：fangzhioo.github.io<br /><br />'
            + '</div>';
        var textData = window.getSelection().getRangeAt(0)
            + '\n\n著作权归作者所有。\n'
            + '商业转载请联系作者获得授权，非商业转载请注明出处。\n'
            + '作者：fangzhioo\n'
            + '链接：'
            + location.href
            + '来源：fangzhioo.github.io\n\n';
        if(event.clipboardData){
            event.clipboardData.setData("text/html", htmlData);
            //setData(剪贴板格式, 数据) 给剪贴板赋予指定格式的数据。返回 true 表示操作成功。
            event.clipboardData.setData("text/plain",textData);
        }
        else if(window.clipboardData){ //window.clipboardData的作用是在页面上将需要的东西复制到剪贴板上，提供了对于预定义的剪贴板格式的访问，以便在编辑操作中使用。
            return window.clipboardData.setData("text", textData);
        }
    };
 
    document.addEventListener('copy',function(e){
        setClipboardText(e);
    });
</script>

<!-- smooth scroll behavior polyfill  -->
<!-- <script type="text/javascript" src="/js/smoothscroll.js"></script> -->



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/fang-zhi-4-73">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/fangzhioooo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/fangzhioo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; 方志 2021 
                    <br>
                    Theme by <a target="_blank" rel="noopener" href="https://huangxuan.me/">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="https://fangzhioo.github.io">Fz</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=fangzhioo&repo=fangzhioo.github.io&type=star&count=true" >
                    </iframe>
                    <br />
                    <!--总访问量统计-->
                    
                        <span id="busuanzi_container_site_pv" style="margin-left: 3px;">
                            总访问量<span id="busuanzi_value_site_pv"></span>次
                        </span>
                    
                    <!--总访问量统计-->

                </p>
            </div>
        </div>
    </div>
</footer>

<!-- Custom Theme JavaScript -->

<script src="/js/my-blog.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://fangzhioo.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-138588101-1';
    var _gaDomain = 'fangzhioo.github.io';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'dce5d892b228cc0a253520da429e7f11';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://fangzhioo.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

<!-- live2d -->
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":true,"debug":false,"model":{"position":"right","width":200,"height":400,"jsonPath":"/live2dw/assets/sagiri.model.json"},"mobile":{"show":true},"react":{"opacity":0.6},"log":false});</script>

</body>

</html>
