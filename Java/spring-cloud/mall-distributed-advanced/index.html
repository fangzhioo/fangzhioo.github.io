<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="æ–¹å¿—çš„ä¸ªäººåšå®¢,fangzhioo,blog">
    <meta name="keyword"  content="æ–¹å¿—,fangzhioo,Fz&#39;s Blog,Kirito,æ¡äºº,åšå®¢,äº’è”ç½‘,Web,JavaScript,Html,Css,Vue.js,React.js,å‰ç«¯,è®¾è®¡,spring, spring cloud, spring cloud alibaba, spring boot, mall, docker, mysql, nacos, ElasticSearch">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          ã€Spring-cloudã€‘guliå•†åŸ-åˆ†å¸ƒå¼è¿›é˜¶ - æ–¹å¿— | fangzhioo
        
    </title>

    <link rel="canonical" href="https://fangzhioo.github.io/Java/spring-cloud/mall-distributed-advanced/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
<link rel="stylesheet" href="/css/beantech.min.css">


    
<link rel="stylesheet" href="/css/donate.css">

    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/prism.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/toc.css">


    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script>
      // ga
      window.onload = function() {
        setTimeout(function() {
          let script = document.createElement("script");
          script.setAttribute("async", "");
          script.src = "//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3409699730406381";
          document.body.appendChild(script);
        }, 2e3);
      }
    </script>

    <!--ä¸è’œå­-->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- jQuery -->
    <!-- 
<script src="/js/jquery.min.js"></script>
 -->
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <!-- 
<script src="/js/bootstrap.min.js"></script>
 -->
    <script src="https://cdn.bootcss.com/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <!-- google ad -->
    <script data-ad-client="ca-pub-3409699730406381" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('//www.talklee.com/api/bing?rand=true')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#SpringCloud" title="SpringCloud">SpringCloud</a>
                            
                              <a class="tag" href="/tags/#ElasticSearch" title="ElasticSearch">ElasticSearch</a>
                            
                        </div>
                        <h1>ã€Spring-cloudã€‘guliå•†åŸ-åˆ†å¸ƒå¼è¿›é˜¶</h1>
                        <h2 class="subheading">SpringBootæ•´åˆElasticSearch</h2>

                        <!--æ–‡ç« è®¿é—®é‡ç»Ÿè®¡-->
                        
                            <span id="busuanzi_container_page_pv">æœ¬æ–‡å·²è¢«é˜…è¯»è¿‡<span id="busuanzi_value_page_pv"></span>æ¬¡</span>
                        
                        <!--æ–‡ç« è®¿é—®é‡ç»Ÿè®¡-->

                        <span class="meta">
                            Posted by æ–¹å¿— on
                            2021-06-02
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Fz Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    
                        <li>
                            <a href="/archive/" >Archives</a>
                        </li>
                    
                        <li>
                            <a href="/tags/" >Tags</a>
                        </li>
                    
                        <li>
                            <a href="/about/" >About</a>
                        </li>
                    

                    <!-- 

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                    

                        
                    

                        
                    

                        
                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/love/">âœ¨è‡´æˆ‘çš„å°å¯çˆ±ğŸ’•ï½</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                     -->
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <blockquote>
<p>ä¸€ä¸‹å†…å®¹æ¥è‡ª <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1np4y1C7Yf">å°šç¡…è°·â€”â€”å…¨ç½‘æœ€å¼ºç”µå•†æ•™ç¨‹ã€Šè°·ç²’å•†åŸã€‹</a></p>
</blockquote>
<h2 id="1-ELASTICSEARCH"><a href="#1-ELASTICSEARCH" class="headerlink" title="1. ELASTICSEARCH"></a>1. ELASTICSEARCH</h2><h3 id="1ã€å®‰è£…elastic-search"><a href="#1ã€å®‰è£…elastic-search" class="headerlink" title="1ã€å®‰è£…elastic search"></a>1ã€å®‰è£…elastic search</h3><p> dokcerä¸­å®‰è£…elastic search</p>
<p>ï¼ˆ1ï¼‰ä¸‹è½½ealastic searchå’Œkibana</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker pull elasticsearch:7.6.2
docker pull kibana:7.6.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ï¼ˆ2ï¼‰é…ç½®</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">mkdir</span> -p /mydata/elasticsearch/config
<span class="token function">mkdir</span> -p /mydata/elasticsearch/data
<span class="token builtin class-name">echo</span> <span class="token string">"http.host: 0.0.0.0"</span> <span class="token operator">></span>/mydata/elasticsearch/config/elasticsearch.yml
<span class="token function">chmod</span> -R <span class="token number">777</span> /mydata/elasticsearch/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p>ï¼ˆ3ï¼‰å¯åŠ¨Elastic search</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker run --name elasticsearch -p <span class="token number">9200</span>:9200 -p <span class="token number">9300</span>:9300 <span class="token punctuation">\</span>
-e  <span class="token string">"discovery.type=single-node"</span> <span class="token punctuation">\</span>
-e <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">"-Xms64m -Xmx512m"</span> <span class="token punctuation">\</span>
-v /mydata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml <span class="token punctuation">\</span>
-v /mydata/elasticsearch/data:/usr/share/elasticsearch/data <span class="token punctuation">\</span>
-v  /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins <span class="token punctuation">\</span>
-d elasticsearch:7.6.2 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¾ç½®å¼€æœºå¯åŠ¨elasticsearch</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker update elasticsearch --restart<span class="token operator">=</span>always<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>ï¼ˆ4ï¼‰å¯åŠ¨kibanaï¼š</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker run --name kibana -e <span class="token assign-left variable">ELASTICSEARCH_HOSTS</span><span class="token operator">=</span>http://192.168.137.14:9200 -p <span class="token number">5601</span>:5601 -d kibana:7.6.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®¾ç½®å¼€æœºå¯åŠ¨kibana</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker update kibana  --restart<span class="token operator">=</span>always<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<p>ï¼ˆ5ï¼‰æµ‹è¯•</p>
<p>æŸ¥çœ‹elasticsearchç‰ˆæœ¬ä¿¡æ¯ï¼š <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/">http://192.168.137.14:9200/</a> </p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"0adeb7852e00"</span><span class="token punctuation">,</span>
    <span class="token property">"cluster_name"</span><span class="token operator">:</span> <span class="token string">"elasticsearch"</span><span class="token punctuation">,</span>
    <span class="token property">"cluster_uuid"</span><span class="token operator">:</span> <span class="token string">"9gglpP0HTfyOTRAaSe2rIg"</span><span class="token punctuation">,</span>
    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"number"</span><span class="token operator">:</span> <span class="token string">"7.6.2"</span><span class="token punctuation">,</span>
        <span class="token property">"build_flavor"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
        <span class="token property">"build_type"</span><span class="token operator">:</span> <span class="token string">"docker"</span><span class="token punctuation">,</span>
        <span class="token property">"build_hash"</span><span class="token operator">:</span> <span class="token string">"ef48eb35cf30adf4db14086e8aabd07ef6fb113f"</span><span class="token punctuation">,</span>
        <span class="token property">"build_date"</span><span class="token operator">:</span> <span class="token string">"2020-03-26T06:34:37.794943Z"</span><span class="token punctuation">,</span>
        <span class="token property">"build_snapshot"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"lucene_version"</span><span class="token operator">:</span> <span class="token string">"8.4.0"</span><span class="token punctuation">,</span>
        <span class="token property">"minimum_wire_compatibility_version"</span><span class="token operator">:</span> <span class="token string">"6.8.0"</span><span class="token punctuation">,</span>
        <span class="token property">"minimum_index_compatibility_version"</span><span class="token operator">:</span> <span class="token string">"6.0.0-beta1"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"tagline"</span><span class="token operator">:</span> <span class="token string">"You Know, for Search"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æ˜¾ç¤ºelasticsearch èŠ‚ç‚¹ä¿¡æ¯<a target="_blank" rel="noopener" href="http://192.168.137.14:9200/_cat/nodes">http://192.168.137.14:9200/_cat/nodes</a> ï¼Œ</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token number">127.0</span>.<span class="token number">0.1</span> <span class="token number">76</span> <span class="token number">95</span> <span class="token number">1</span> <span class="token number">0.26</span> <span class="token number">1.40</span> <span class="token number">1.22</span> dilm * 0adeb7852e00<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>è®¿é—®Kibanaï¼š <a target="_blank" rel="noopener" href="http://192.168.137.14:5601/app/kibana">http://192.168.137.14:5601/app/kibana</a> </p>
<p><img src="/img/spring-cloud/image-20200501192629304.png" alt="image-20200501192629304"></p>
<h3 id="2ã€åˆæ­¥æ£€ç´¢"><a href="#2ã€åˆæ­¥æ£€ç´¢" class="headerlink" title="2ã€åˆæ­¥æ£€ç´¢"></a>2ã€åˆæ­¥æ£€ç´¢</h3><h4 id="1ï¼‰-CAT"><a href="#1ï¼‰-CAT" class="headerlink" title="1ï¼‰_CAT"></a>1ï¼‰_CAT</h4><p>ï¼ˆ1ï¼‰GET/<em>cat/nodesï¼šæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</em></p>
<p> å¦‚ï¼š<a target="_blank" rel="noopener" href="http://192.168.137.14:9200/_cat/nodes">http://192.168.137.14:9200/_cat/nodes</a> :</p>
<pre class="line-numbers language-none"><code class="language-none">127.0.0.1 61 91 11 0.08 0.49 0.87 dilm * 0adeb7852e00<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ³¨ï¼š*è¡¨ç¤ºé›†ç¾¤ä¸­çš„ä¸»èŠ‚ç‚¹</p>
<p>ï¼ˆ2ï¼‰GET/<em>cat/healthï¼šæŸ¥çœ‹eså¥åº·çŠ¶å†µ</em></p>
<p>å¦‚ï¼š <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/_cat/health">http://192.168.137.14:9200/_cat/health</a> </p>
<pre class="line-numbers language-none"><code class="language-none">1588332616 11:30:16 elasticsearch green 1 1 3 3 0 0 0 0 - 100.0%<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ³¨ï¼šgreenè¡¨ç¤ºå¥åº·å€¼æ­£å¸¸</p>
<p>ï¼ˆ3ï¼‰GET/<em>cat/masterï¼šæŸ¥çœ‹ä¸»èŠ‚ç‚¹</em></p>
<p>å¦‚ï¼š <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/_cat/master">http://192.168.137.14:9200/_cat/master</a> </p>
<pre class="line-numbers language-none"><code class="language-none">vfpgxbusTC6-W3C2Np31EQ 127.0.0.1 127.0.0.1 0adeb7852e00<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ï¼ˆ4ï¼‰GET/_cat/indiciesï¼šæŸ¥çœ‹æ‰€æœ‰ç´¢å¼• ï¼Œç­‰ä»·äºmysqlæ•°æ®åº“çš„show databases;</p>
<p>å¦‚ï¼š <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/_cat/indices">http://192.168.137.14:9200/_cat/indices</a> </p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">green open .kibana_task_manager_1   KWLtjcKRRuaV9so_v15WYg <span class="token number">1</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">39</span>.8kb <span class="token number">39</span>.8kb
green open .apm-agent-configuration cuwCpJ5ER0OYsSgAJ7bVYA <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>   283b   283b
green open .kibana_1                PqK_LdUYRpWMy4fK0tMSPw <span class="token number">1</span> <span class="token number">0</span> <span class="token number">7</span> <span class="token number">0</span> <span class="token number">31</span>.2kb <span class="token number">31</span>.2kb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="2ï¼‰ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£"><a href="#2ï¼‰ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£" class="headerlink" title="2ï¼‰ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£"></a>2ï¼‰ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£</h4><p>ä¿å­˜ä¸€ä¸ªæ•°æ®ï¼Œä¿å­˜åœ¨å“ªä¸ªç´¢å¼•çš„å“ªä¸ªç±»å‹ä¸‹ï¼ŒæŒ‡å®šç”¨é‚£ä¸ªå”¯ä¸€æ ‡è¯†<br>PUT customer/external/1;åœ¨customerç´¢å¼•ä¸‹çš„externalç±»å‹ä¸‹ä¿å­˜1å·æ•°æ®ä¸º</p>
<pre class="line-numbers language-none"><code class="language-none">PUT customer&#x2F;external&#x2F;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
 <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"John Doe"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>PUTå’ŒPOSTéƒ½å¯ä»¥<br>POSTæ–°å¢ã€‚å¦‚æœä¸æŒ‡å®šidï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆidã€‚æŒ‡å®šidå°±ä¼šä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œå¹¶æ–°å¢ç‰ˆæœ¬å·ï¼›<br>PUTå¯ä»¥æ–°å¢ä¹Ÿå¯ä»¥ä¿®æ”¹ã€‚PUTå¿…é¡»æŒ‡å®šidï¼›ç”±äºPUTéœ€è¦æŒ‡å®šidï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨æ¥åšä¿®æ”¹æ“ä½œï¼Œä¸æŒ‡å®šidä¼šæŠ¥é”™ã€‚</p>
<p>ä¸‹é¢æ˜¯åœ¨postmanä¸­çš„æµ‹è¯•æ•°æ®ï¼š<br><img src="/img/spring-cloud/image-20200501194449944.png" alt="image-20200501194449944"></p>
<p>åˆ›å»ºæ•°æ®æˆåŠŸåï¼Œæ˜¾ç¤º201 createdè¡¨ç¤ºæ’å…¥è®°å½•æˆåŠŸã€‚</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"_index"</span><span class="token operator">:</span> <span class="token string">"customer"</span><span class="token punctuation">,</span>
    <span class="token property">"_type"</span><span class="token operator">:</span> <span class="token string">"external"</span><span class="token punctuation">,</span>
    <span class="token property">"_id"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
    <span class="token property">"_version"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token string">"created"</span><span class="token punctuation">,</span>
    <span class="token property">"_shards"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">"successful"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"failed"</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"_seq_no"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"_primary_term"</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™äº›è¿”å›çš„JSONä¸²çš„å«ä¹‰ï¼›è¿™äº›å¸¦æœ‰ä¸‹åˆ’çº¿å¼€å¤´çš„ï¼Œç§°ä¸ºå…ƒæ•°æ®ï¼Œåæ˜ äº†å½“å‰çš„åŸºæœ¬ä¿¡æ¯ã€‚</p>
<p>â€œ_indexâ€: â€œcustomerâ€ è¡¨æ˜è¯¥æ•°æ®åœ¨å“ªä¸ªæ•°æ®åº“ä¸‹ï¼›</p>
<p>â€œ_typeâ€: â€œexternalâ€     è¡¨æ˜è¯¥æ•°æ®åœ¨å“ªä¸ªç±»å‹ä¸‹ï¼›</p>
<p>â€œ_idâ€: â€œ1â€                    è¡¨æ˜è¢«ä¿å­˜æ•°æ®çš„idï¼›</p>
<p> â€œ_versionâ€: 1,            è¢«ä¿å­˜æ•°æ®çš„ç‰ˆæœ¬</p>
<p>â€œresultâ€: â€œcreatedâ€      è¿™é‡Œæ˜¯åˆ›å»ºäº†ä¸€æ¡æ•°æ®ï¼Œå¦‚æœé‡æ–°putä¸€æ¡æ•°æ®ï¼Œåˆ™è¯¥çŠ¶æ€ä¼šå˜ä¸ºupdatedï¼Œå¹¶ä¸”ç‰ˆæœ¬å·ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
<p>ä¸‹é¢é€‰ç”¨POSTæ–¹å¼ï¼š</p>
<p>æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼Œä¸æŒ‡å®šIDï¼Œä¼šè‡ªåŠ¨çš„ç”Ÿæˆidï¼Œå¹¶ä¸”ç±»å‹æ˜¯æ–°å¢ï¼š</p>
<img src="images/image-20200501195619925.png" alt="image-20200501195619925" style="zoom: 52%;" />

<p>å†æ¬¡ä½¿ç”¨POSTæ’å…¥æ•°æ®ï¼Œä»ç„¶æ˜¯æ–°å¢çš„ï¼š</p>
<img src="images/image-20200501195732492.png" alt="image-20200501195732492" style="zoom: 80%;" />



<p>æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼ŒæŒ‡å®šIDï¼Œä¼šä½¿ç”¨è¯¥idï¼Œå¹¶ä¸”ç±»å‹æ˜¯æ–°å¢ï¼š</p>
<img src="images/image-20200501200048361.png" alt="image-20200501200048361" style="zoom: 66%;" />

<p>å†æ¬¡ä½¿ç”¨POSTæ’å…¥æ•°æ®ï¼Œç±»å‹ä¸ºupdated</p>
<img src="images/image-20200501200132199.png" alt="image-20200501200132199" style="zoom:67%;" />



<h4 id="3ï¼‰æŸ¥çœ‹æ–‡æ¡£"><a href="#3ï¼‰æŸ¥çœ‹æ–‡æ¡£" class="headerlink" title="3ï¼‰æŸ¥çœ‹æ–‡æ¡£"></a>3ï¼‰æŸ¥çœ‹æ–‡æ¡£</h4><p>GET /customer/external/1</p>
<p> <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/customer/external/1">http://192.168.137.14:9200/customer/external/1</a> </p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"_index"</span><span class="token operator">:</span> <span class="token string">"customer"</span><span class="token punctuation">,</span><span class="token comment">//åœ¨å“ªä¸ªç´¢å¼•</span>
    <span class="token property">"_type"</span><span class="token operator">:</span> <span class="token string">"external"</span><span class="token punctuation">,</span><span class="token comment">//åœ¨å“ªä¸ªç±»å‹</span>
    <span class="token property">"_id"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span><span class="token comment">//è®°å½•id</span>
    <span class="token property">"_version"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token comment">//ç‰ˆæœ¬å·</span>
    <span class="token property">"_seq_no"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token comment">//å¹¶å‘æ§åˆ¶å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä¼š+1ï¼Œç”¨æ¥åšä¹è§‚é”</span>
    <span class="token property">"_primary_term"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//åŒä¸Šï¼Œä¸»åˆ†ç‰‡é‡æ–°åˆ†é…ï¼Œå¦‚é‡å¯ï¼Œå°±ä¼šå˜åŒ–</span>
    <span class="token property">"found"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"John Doe"</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€šè¿‡â€œif_seq_no=1&amp;if_primary_term=1 â€ï¼Œå½“åºåˆ—å·åŒ¹é…çš„æ—¶å€™ï¼Œæ‰è¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¿®æ”¹ã€‚</p>
<p>å®ä¾‹ï¼šå°†id=1çš„æ•°æ®æ›´æ–°ä¸ºname=1ï¼Œç„¶åå†æ¬¡æ›´æ–°ä¸ºname=2ï¼Œèµ·å§‹_seq_no=6ï¼Œ_primary_term=1</p>
<p>ï¼ˆ1ï¼‰å°†nameæ›´æ–°ä¸º1</p>
<p> <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/customer/external/1?if_seq_no=6&amp;if_primary_term=1">http://192.168.137.14:9200/customer/external/1?if_seq_no=6&amp;if_primary_term=1</a> </p>
<img src="images/image-20200501212224983.png" alt="image-20200501212224983" style="zoom: 61%;" />

<p> ï¼ˆ2ï¼‰å°†nameæ›´æ–°ä¸º2ï¼Œæ›´æ–°è¿‡ç¨‹ä¸­ä½¿ç”¨seq_no=6</p>
<p><a target="_blank" rel="noopener" href="http://192.168.137.14:9200/customer/external/1?if_seq_no=6&amp;if_primary_term=1">http://192.168.137.14:9200/customer/external/1?if_seq_no=6&amp;if_primary_term=1</a> </p>
<img src="images/image-20200501213047499.png" alt="image-20200501213047499" style="zoom: 60%;" />

<p>å‡ºç°æ›´æ–°é”™è¯¯ã€‚</p>
<p>ï¼ˆ3ï¼‰æŸ¥è¯¢æ–°çš„æ•°æ®</p>
<p> <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/customer/external/1">http://192.168.137.14:9200/customer/external/1</a> </p>
<p><img src="/img/spring-cloud/image-20200501212924094.png" alt="image-20200501212924094"></p>
<p>èƒ½å¤Ÿçœ‹åˆ°_seq_noå˜ä¸º7ã€‚</p>
<p>ï¼ˆ4ï¼‰å†æ¬¡æ›´æ–°ï¼Œæ›´æ–°æˆåŠŸ</p>
<p> <a target="_blank" rel="noopener" href="http://192.168.137.14:9200/customer/external/1?if_seq_no=7&amp;if_primary_term=1">http://192.168.137.14:9200/customer/external/1?if_seq_no=7&amp;if_primary_term=1</a> </p>
<img src="images/image-20200501213130001.png" alt="image-20200501213130001" style="zoom:75%;" />

<h4 id="4ï¼‰æ›´æ–°æ–‡æ¡£"><a href="#4ï¼‰æ›´æ–°æ–‡æ¡£" class="headerlink" title="4ï¼‰æ›´æ–°æ–‡æ¡£"></a>4ï¼‰æ›´æ–°æ–‡æ¡£</h4><p><img src="/img/spring-cloud/image-20200501214522818.png" alt="image-20200501214522818"></p>
<p> <img src="/img/spring-cloud/image-20200501215746139.png" alt="image-20200501215746139"></p>
<p>ï¼ˆ1ï¼‰POSTæ›´æ–°æ–‡æ¡£ï¼Œå¸¦æœ‰_update</p>
<p><a target="_blank" rel="noopener" href="http://192.168.137.14:9200/customer/external/1/_update">http://192.168.137.14:9200/customer/external/1/_update</a> </p>
<p><img src="/img/spring-cloud/image-20200501214810741.png" alt="image-20200501214810741"></p>
<p>å¦‚æœå†æ¬¡æ‰§è¡Œæ›´æ–°ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œåºåˆ—å·ä¹Ÿä¸å‘ç”Ÿå˜åŒ–</p>
<p><img src="/img/spring-cloud/image-20200501214912607.png" alt="image-20200501214912607"></p>
<p>POSTæ›´æ–°æ–¹å¼ï¼Œä¼šå¯¹æ¯”åŸæ¥çš„æ•°æ®ï¼Œå’ŒåŸæ¥çš„ç›¸åŒï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼ˆversionå’Œ_seq_noï¼‰éƒ½ä¸å˜ã€‚</p>
<p> ï¼ˆ2ï¼‰POSTæ›´æ–°æ–‡æ¡£ï¼Œä¸å¸¦_update</p>
<p><img src="/img/spring-cloud/image-20200501215358666.png" alt="image-20200501215358666"></p>
<p>åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œé‡å¤æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œæ•°æ®ä¹Ÿèƒ½å¤Ÿæ›´æ–°æˆåŠŸï¼Œä¸ä¼šå’ŒåŸæ¥çš„æ•°æ®è¿›è¡Œå¯¹æ¯”ã€‚</p>
<h4 id="5ï¼‰åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•"><a href="#5ï¼‰åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•" class="headerlink" title="5ï¼‰åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•"></a>5ï¼‰åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•</h4><pre class="line-numbers language-none"><code class="language-none">DELETE customer&#x2F;external&#x2F;1
DELETE customer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ³¨ï¼šelasticsearchå¹¶æ²¡æœ‰æä¾›åˆ é™¤ç±»å‹çš„æ“ä½œï¼Œåªæä¾›äº†åˆ é™¤ç´¢å¼•å’Œæ–‡æ¡£çš„æ“ä½œã€‚</p>
<p>å®ä¾‹ï¼šåˆ é™¤id=1çš„æ•°æ®ï¼Œåˆ é™¤åç»§ç»­æŸ¥è¯¢</p>
<img src="images/image-20200501220559094.png" alt="image-20200501220559094" style="zoom:67%;" />

<p>å®ä¾‹ï¼šåˆ é™¤æ•´ä¸ªcostomerç´¢å¼•æ•°æ®</p>
<p>åˆ é™¤å‰ï¼Œæ‰€æœ‰çš„ç´¢å¼•</p>
<pre class="line-numbers language-none"><code class="language-none">green  open .kibana_task_manager_1   KWLtjcKRRuaV9so_v15WYg 1 0 2 0 39.8kb 39.8kb
green  open .apm-agent-configuration cuwCpJ5ER0OYsSgAJ7bVYA 1 0 0 0   283b   283b
green  open .kibana_1                PqK_LdUYRpWMy4fK0tMSPw 1 0 7 0 31.2kb 31.2kb
yellow open customer                 nzDYCdnvQjSsapJrAIT8Zw 1 1 4 0  4.4kb  4.4kb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ é™¤â€œ customer â€ç´¢å¼•</p>
<p><img src="/img/spring-cloud/image-20200501221105476.png" alt="image-20200501221105476"></p>
<p>åˆ é™¤åï¼Œæ‰€æœ‰çš„ç´¢å¼•</p>
<pre class="line-numbers language-none"><code class="language-none">green  open .kibana_task_manager_1   KWLtjcKRRuaV9so_v15WYg 1 0 2 0 39.8kb 39.8kb
green  open .apm-agent-configuration cuwCpJ5ER0OYsSgAJ7bVYA 1 0 0 0   283b   283b
green  open .kibana_1                PqK_LdUYRpWMy4fK0tMSPw 1 0 7 0 31.2kb 31.2kb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h4 id="6ï¼‰eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk"><a href="#6ï¼‰eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk" class="headerlink" title="6ï¼‰eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk"></a>6ï¼‰eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk</h4><p>è¯­æ³•æ ¼å¼ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>action<span class="token operator">:</span><span class="token punctuation">&#123;</span>metadata<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>\n
<span class="token punctuation">&#123;</span>request body  <span class="token punctuation">&#125;</span>\n

<span class="token punctuation">&#123;</span>action<span class="token operator">:</span><span class="token punctuation">&#123;</span>metadata<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>\n
<span class="token punctuation">&#123;</span>request body  <span class="token punctuation">&#125;</span>\n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œçš„æ‰¹é‡æ“ä½œï¼Œå½“å‘ç”ŸæŸä¸€æ¡æ‰§è¡Œå‘ç”Ÿå¤±è´¥æ—¶ï¼Œå…¶ä»–çš„æ•°æ®ä»ç„¶èƒ½å¤Ÿæ¥ç€æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å½¼æ­¤ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€‚</p>
<p>bulk apiä»¥æ­¤æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰çš„actionï¼ˆåŠ¨ä½œï¼‰ã€‚å¦‚æœä¸€ä¸ªå•ä¸ªçš„åŠ¨ä½œå› ä»»ä½•åŸå› å¤±è´¥ï¼Œå®ƒå°†ç»§ç»­å¤„ç†å®ƒåé¢å‰©ä½™çš„åŠ¨ä½œã€‚å½“bulk apiè¿”å›æ—¶ï¼Œå®ƒå°†æä¾›æ¯ä¸ªåŠ¨ä½œçš„çŠ¶æ€ï¼ˆä¸å‘é€çš„é¡ºåºç›¸åŒï¼‰ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦ä¸€ä¸ªæŒ‡å®šçš„åŠ¨ä½œæ˜¯å¦å¤±è´¥äº†ã€‚</p>
<p>å®ä¾‹1: æ‰§è¡Œå¤šæ¡æ•°æ®</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST customer/external/_bulk
<span class="token punctuation">&#123;</span><span class="token property">"index"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token string">"1"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"John Doe"</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"index"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token string">"2"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"John Doe"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">#! Deprecation<span class="token operator">:</span> <span class="token punctuation">[</span>types removal<span class="token punctuation">]</span> Specifying types in bulk requests is deprecated.
<span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">491</span><span class="token punctuation">,</span>
  <span class="token property">"errors"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"items"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"customer"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"external"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"_version"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"result"</span> <span class="token operator">:</span> <span class="token string">"created"</span><span class="token punctuation">,</span>
        <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"_seq_no"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"_primary_term"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"status"</span> <span class="token operator">:</span> <span class="token number">201</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"customer"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"external"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
        <span class="token property">"_version"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"result"</span> <span class="token operator">:</span> <span class="token string">"created"</span><span class="token punctuation">,</span>
        <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"_seq_no"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"_primary_term"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"status"</span> <span class="token operator">:</span> <span class="token number">201</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>å®ä¾‹2ï¼šå¯¹äºæ•´ä¸ªç´¢å¼•æ‰§è¡Œæ‰¹é‡æ“ä½œ</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST /_bulk
<span class="token punctuation">&#123;</span><span class="token property">"delete"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token string">"website"</span><span class="token punctuation">,</span><span class="token property">"_type"</span><span class="token operator">:</span><span class="token string">"blog"</span><span class="token punctuation">,</span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token string">"123"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"create"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token string">"website"</span><span class="token punctuation">,</span><span class="token property">"_type"</span><span class="token operator">:</span><span class="token string">"blog"</span><span class="token punctuation">,</span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token string">"123"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"title"</span><span class="token operator">:</span><span class="token string">"my first blog post"</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"index"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token string">"website"</span><span class="token punctuation">,</span><span class="token property">"_type"</span><span class="token operator">:</span><span class="token string">"blog"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"title"</span><span class="token operator">:</span><span class="token string">"my second blog post"</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"update"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token string">"website"</span><span class="token punctuation">,</span><span class="token property">"_type"</span><span class="token operator">:</span><span class="token string">"blog"</span><span class="token punctuation">,</span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token string">"123"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"doc"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"title"</span><span class="token operator">:</span><span class="token string">"my updated blog post"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">#! Deprecation<span class="token operator">:</span> <span class="token punctuation">[</span>types removal<span class="token punctuation">]</span> Specifying types in bulk requests is deprecated.
<span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">608</span><span class="token punctuation">,</span>
  <span class="token property">"errors"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"items"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"delete"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"website"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"blog"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span>
        <span class="token property">"_version"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"result"</span> <span class="token operator">:</span> <span class="token string">"not_found"</span><span class="token punctuation">,</span>
        <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"_seq_no"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"_primary_term"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"status"</span> <span class="token operator">:</span> <span class="token number">404</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"create"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"website"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"blog"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span>
        <span class="token property">"_version"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">"result"</span> <span class="token operator">:</span> <span class="token string">"created"</span><span class="token punctuation">,</span>
        <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"_seq_no"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"_primary_term"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"status"</span> <span class="token operator">:</span> <span class="token number">201</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"website"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"blog"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"MCOs0HEBHYK_MJXUyYIz"</span><span class="token punctuation">,</span>
        <span class="token property">"_version"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"result"</span> <span class="token operator">:</span> <span class="token string">"created"</span><span class="token punctuation">,</span>
        <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"_seq_no"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">"_primary_term"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"status"</span> <span class="token operator">:</span> <span class="token number">201</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"update"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"website"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"blog"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span>
        <span class="token property">"_version"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">"result"</span> <span class="token operator">:</span> <span class="token string">"updated"</span><span class="token punctuation">,</span>
        <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"_seq_no"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">"_primary_term"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"status"</span> <span class="token operator">:</span> <span class="token number">200</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="7ï¼‰æ ·æœ¬æµ‹è¯•æ•°æ®"><a href="#7ï¼‰æ ·æœ¬æµ‹è¯•æ•°æ®" class="headerlink" title="7ï¼‰æ ·æœ¬æµ‹è¯•æ•°æ®"></a>7ï¼‰æ ·æœ¬æµ‹è¯•æ•°æ®</h4><p>å‡†å¤‡äº†ä¸€ä»½é¡¾å®¢é“¶è¡Œè´¦æˆ·ä¿¡æ¯çš„è™šæ„çš„JSONæ–‡æ¡£æ ·æœ¬ã€‚æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸‹åˆ—çš„schemaï¼ˆæ¨¡å¼ï¼‰ã€‚</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">"balance"</span><span class="token operator">:</span> <span class="token number">39225</span><span class="token punctuation">,</span>
	<span class="token property">"firstname"</span><span class="token operator">:</span> <span class="token string">"Amber"</span><span class="token punctuation">,</span>
	<span class="token property">"lastname"</span><span class="token operator">:</span> <span class="token string">"Duke"</span><span class="token punctuation">,</span>
	<span class="token property">"age"</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
	<span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
	<span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"880 Holmes Lane"</span><span class="token punctuation">,</span>
	<span class="token property">"employer"</span><span class="token operator">:</span> <span class="token string">"Pyrami"</span><span class="token punctuation">,</span>
	<span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"amberduke@pyrami.com"</span><span class="token punctuation">,</span>
	<span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"Brogan"</span><span class="token punctuation">,</span>
	<span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"IL"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> <a target="_blank" rel="noopener" href="https://github.com/elastic/elasticsearch/blob/master/docs/src/test/resources/accounts.json">https://github.com/elastic/elasticsearch/blob/master/docs/src/test/resources/accounts.json</a> ï¼Œå¯¼å…¥æµ‹è¯•æ•°æ®ï¼Œ</p>
<p>POST bank/account/_bulk</p>
<h3 id="3ã€æ£€ç´¢"><a href="#3ã€æ£€ç´¢" class="headerlink" title="3ã€æ£€ç´¢"></a>3ã€æ£€ç´¢</h3><h4 id="1ï¼‰search-Api"><a href="#1ï¼‰search-Api" class="headerlink" title="1ï¼‰search Api"></a>1ï¼‰search Api</h4><p>ESæ”¯æŒä¸¤ç§åŸºæœ¬æ–¹å¼æ£€ç´¢ï¼›</p>
<ul>
<li>é€šè¿‡REST request uri å‘é€æœç´¢å‚æ•° ï¼ˆuri +æ£€ç´¢å‚æ•°ï¼‰ï¼›</li>
<li>é€šè¿‡REST request body æ¥å‘é€å®ƒä»¬ï¼ˆuri+è¯·æ±‚ä½“ï¼‰ï¼›</li>
</ul>
<p>ä¿¡æ¯æ£€ç´¢</p>
<p><img src="/img/spring-cloud/image-20200501233938697.png" alt="image-20200501233938697"></p>
<p><img src="/img/spring-cloud/image-20200502000221422.png" alt="image-20200502000221422"></p>
<p><img src="/img/spring-cloud/image-20200502000733594.png" alt="image-20200502000733594"></p>
<p>uri+è¯·æ±‚ä½“è¿›è¡Œæ£€ç´¢</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET /bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span> <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token string">"asc"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token property">"balance"</span><span class="token operator">:</span><span class="token string">"desc"</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>HTTPå®¢æˆ·ç«¯å·¥å…·ï¼ˆï¼‰ï¼Œgetè¯·æ±‚ä¸èƒ½å¤Ÿæºå¸¦è¯·æ±‚ä½“ï¼Œ</p>
<pre class="line-numbers language-none"><code class="language-none">GET bank&#x2F;_search?q&#x3D;*&amp;sort&#x3D;account_number:asc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿”å›ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">235</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16623</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Bradshaw"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Mckenzie"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"244 Columbus Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Euron"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"bradshawmckenzie@euron.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Hobucken"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"CO"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">0</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">39225</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Amber"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Duke"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"880 Holmes Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pyrami"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"amberduke@pyrami.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Brogan"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">1</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">28838</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Roberta"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Bender"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"560 Kingsway Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Chillium"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"robertabender@chillium.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Bennett"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"LA"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">2</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">44947</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Levine"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Burks"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"328 Wilson Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Amtap"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"levineburks@amtap.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Cochranville"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"HI"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">3</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">27658</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Rodriquez"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Flores"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"986 Wyckoff Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Tourmania"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"rodriquezflores@tourmania.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Eastvale"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"HI"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">4</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"5"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">29342</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Leola"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Stewart"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"311 Elm Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Diginetic"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"leolastewart@diginetic.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Fairview"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"NJ"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">5</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"6"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">5686</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Hattie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Bond"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"671 Bristol Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Netagy"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"hattiebond@netagy.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Dante"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"TN"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">6</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"7"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">39121</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Levy"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Richard"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"820 Logan Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Teraprene"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"levyrichard@teraprene.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Shrewsbury"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"MO"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">7</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"8"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">48868</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Jan"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Burns"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"699 Visitation Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Glasstep"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"janburns@glasstep.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Wakulla"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AZ"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">8</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"9"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">24776</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Opal"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Meadows"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"963 Neptune Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Cedward"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"opalmeadows@cedward.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Olney"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"OH"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">9</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>ï¼ˆ1ï¼‰åªæœ‰6æ¡æ•°æ®ï¼Œè¿™æ˜¯å› ä¸ºå­˜åœ¨åˆ†é¡µæŸ¥è¯¢ï¼›</p>
<p>ï¼ˆ2ï¼‰è¯¦ç»†çš„å­—æ®µä¿¡æ¯ï¼Œå‚ç…§ï¼š <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html</a> </p>
<blockquote>
<p>The response also provides the following information about the search request:</p>
<ul>
<li><code>took</code> â€“ how long it took Elasticsearch to run the query, in milliseconds</li>
<li><code>timed_out</code> â€“ whether or not the search request timed out</li>
<li><code>_shards</code> â€“ how many shards were searched and a breakdown of how many shards succeeded, failed, or were skipped.</li>
<li><code>max_score</code> â€“ the score of the most relevant document found</li>
<li><code>hits.total.value</code> - how many matching documents were found</li>
<li><code>hits.sort</code> - the documentâ€™s sort position (when not sorting by relevance score)</li>
<li><code>hits._score</code> - the documentâ€™s relevance score (not applicable when using <code>match_all</code>)</li>
</ul>
</blockquote>
<h4 id="2ï¼‰Query-DSL"><a href="#2ï¼‰Query-DSL" class="headerlink" title="2ï¼‰Query DSL"></a>2ï¼‰Query DSL</h4><h5 id="ï¼ˆ1ï¼‰åŸºæœ¬è¯­æ³•æ ¼å¼"><a href="#ï¼ˆ1ï¼‰åŸºæœ¬è¯­æ³•æ ¼å¼" class="headerlink" title="ï¼ˆ1ï¼‰åŸºæœ¬è¯­æ³•æ ¼å¼"></a>ï¼ˆ1ï¼‰åŸºæœ¬è¯­æ³•æ ¼å¼</h5><p>Elasticsearchæä¾›äº†ä¸€ä¸ªå¯ä»¥æ‰§è¡ŒæŸ¥è¯¢çš„Jsoné£æ ¼çš„DSLã€‚è¿™ä¸ªè¢«ç§°ä¸ºQuery DSLï¼Œè¯¥æŸ¥è¯¢è¯­è¨€éå¸¸å…¨é¢ã€‚</p>
<p>ä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„å…¸å‹ç»“æ„</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">QUERY_NAME<span class="token operator">:</span><span class="token punctuation">&#123;</span>
   ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>
   ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>...
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p>å¦‚æœé’ˆå¯¹äºæŸä¸ªå­—æ®µï¼Œé‚£ä¹ˆå®ƒçš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  QUERY_NAME<span class="token operator">:</span><span class="token punctuation">&#123;</span>
     FIELD_NAME<span class="token operator">:</span><span class="token punctuation">&#123;</span>
       ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>
       ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>...
      <span class="token punctuation">&#125;</span>   
   <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"from"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"order"</span><span class="token operator">:</span> <span class="token string">"desc"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>queryå®šä¹‰å¦‚ä½•æŸ¥è¯¢ï¼›</p>
<ul>
<li>match_allæŸ¥è¯¢ç±»å‹ã€ä»£è¡¨æŸ¥è¯¢æ‰€æœ‰çš„æ‰€æœ‰ã€‘ï¼Œesä¸­å¯ä»¥åœ¨queryä¸­ç»„åˆéå¸¸å¤šçš„æŸ¥è¯¢ç±»å‹å®Œæˆå¤æ‚æŸ¥è¯¢ï¼›</li>
<li>é™¤äº†queryå‚æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä¹Ÿä¼ é€’å…¶ä»–çš„å‚æ•°ä»¥æ”¹å˜æŸ¥è¯¢ç»“æœï¼Œå¦‚sortï¼Œsizeï¼›</li>
<li>from+sizeé™å®šï¼Œå®Œæˆåˆ†é¡µåŠŸèƒ½ï¼›</li>
<li>sortæ’åºï¼Œå¤šå­—æ®µæ’åºï¼Œä¼šåœ¨å‰åºå­—æ®µç›¸ç­‰æ—¶åç»­å­—æ®µå†…éƒ¨æ’åºï¼Œå¦åˆ™ä»¥å‰åºä¸ºå‡†ï¼›</li>
</ul>
<h5 id="ï¼ˆ2ï¼‰è¿”å›éƒ¨åˆ†å­—æ®µ"><a href="#ï¼ˆ2ï¼‰è¿”å›éƒ¨åˆ†å­—æ®µ" class="headerlink" title="ï¼ˆ2ï¼‰è¿”å›éƒ¨åˆ†å­—æ®µ"></a>ï¼ˆ2ï¼‰è¿”å›éƒ¨åˆ†å­—æ®µ</h5><pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"from"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"order"</span><span class="token operator">:</span> <span class="token string">"desc"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">,</span><span class="token string">"firstname"</span><span class="token punctuation">]</span>
  
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"999"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Dorothy"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">6087</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">999</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"998"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Letha"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16869</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">998</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"997"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Combs"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">25311</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">997</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"996"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Andrews"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">17541</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">996</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"995"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Phelps"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">21153</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">995</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="ï¼ˆ3ï¼‰matchåŒ¹é…æŸ¥è¯¢"><a href="#ï¼ˆ3ï¼‰matchåŒ¹é…æŸ¥è¯¢" class="headerlink" title="ï¼ˆ3ï¼‰matchåŒ¹é…æŸ¥è¯¢"></a>ï¼ˆ3ï¼‰matchåŒ¹é…æŸ¥è¯¢</h5><ul>
<li>åŸºæœ¬ç±»å‹ï¼ˆéå­—ç¬¦ä¸²ï¼‰ï¼Œç²¾ç¡®æ§åˆ¶</li>
</ul>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token string">"20"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>matchè¿”å›account_number=20çš„æ•°æ®ã€‚</p>
<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16418</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Elinor"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Ratliff"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"282 Kings Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Scentric"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"elinorratliff@scentric.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Ribera"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"WA"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<ul>
<li>å­—ç¬¦ä¸²ï¼Œå…¨æ–‡æ£€ç´¢</li>
</ul>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"kings"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…¨æ–‡æ£€ç´¢ï¼Œæœ€ç»ˆä¼šæŒ‰ç…§è¯„åˆ†è¿›è¡Œæ’åºï¼Œä¼šå¯¹æ£€ç´¢æ¡ä»¶è¿›è¡Œåˆ†è¯åŒ¹é…ã€‚</p>
<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">5.990829</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.990829</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16418</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Elinor"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Ratliff"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"282 Kings Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Scentric"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"elinorratliff@scentric.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Ribera"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"WA"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"722"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.990829</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">722</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">27256</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Roberts"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Beasley"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"305 Kings Hwy"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Quintity"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"robertsbeasley@quintity.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Hayden"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"PA"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="ï¼ˆ4ï¼‰-match-phrase-çŸ­å¥åŒ¹é…"><a href="#ï¼ˆ4ï¼‰-match-phrase-çŸ­å¥åŒ¹é…" class="headerlink" title="ï¼ˆ4ï¼‰ match_phrase [çŸ­å¥åŒ¹é…]"></a>ï¼ˆ4ï¼‰ match_phrase [çŸ­å¥åŒ¹é…]</h5><p>å°†éœ€è¦åŒ¹é…çš„å€¼å½“æˆä¸€æ•´ä¸ªå•è¯ï¼ˆä¸åˆ†è¯ï¼‰è¿›è¡Œæ£€ç´¢</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match_phrase"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill road"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æŸ¥å¤„addressä¸­åŒ…å«mill_roadçš„æ‰€æœ‰è®°å½•ï¼Œå¹¶ç»™å‡ºç›¸å…³æ€§å¾—åˆ†</p>
<p>æŸ¥çœ‹ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">8.926605</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">8.926605</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>match_phraseå’ŒMatchçš„åŒºåˆ«ï¼Œè§‚å¯Ÿå¦‚ä¸‹å®ä¾‹ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match_phrase"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"990 Mill"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">10.806405</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">10.806405</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>ä½¿ç”¨matchçš„keyword</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address.keyword"</span><span class="token operator">:</span> <span class="token string">"990 Mill"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼Œä¸€æ¡ä¹ŸæœªåŒ¹é…åˆ°</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>ä¿®æ”¹åŒ¹é…æ¡ä»¶ä¸ºâ€œ990 Mill Roadâ€</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address.keyword"</span><span class="token operator">:</span> <span class="token string">"990 Mill Road"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢å‡ºä¸€æ¡æ•°æ®</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.5032897</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.5032897</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æ–‡æœ¬å­—æ®µçš„åŒ¹é…ï¼Œä½¿ç”¨keywordï¼ŒåŒ¹é…çš„æ¡ä»¶å°±æ˜¯è¦æ˜¾ç¤ºå­—æ®µçš„å…¨éƒ¨å€¼ï¼Œè¦è¿›è¡Œç²¾ç¡®åŒ¹é…çš„ã€‚</p>
<p>match_phraseæ˜¯åšçŸ­è¯­åŒ¹é…ï¼Œåªè¦æ–‡æœ¬ä¸­åŒ…å«åŒ¹é…æ¡ä»¶ï¼Œå°±èƒ½åŒ¹é…åˆ°ã€‚</p>
<h5 id="ï¼ˆ5ï¼‰multi-mathã€å¤šå­—æ®µåŒ¹é…ã€‘"><a href="#ï¼ˆ5ï¼‰multi-mathã€å¤šå­—æ®µåŒ¹é…ã€‘" class="headerlink" title="ï¼ˆ5ï¼‰multi_mathã€å¤šå­—æ®µåŒ¹é…ã€‘"></a>ï¼ˆ5ï¼‰multi_mathã€å¤šå­—æ®µåŒ¹é…ã€‘</h5><pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"multi_match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"mill"</span><span class="token punctuation">,</span>
      <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"state"</span><span class="token punctuation">,</span>
        <span class="token string">"address"</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>stateæˆ–è€…addressä¸­åŒ…å«millï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œä¼šå¯¹äºæŸ¥è¯¢æ¡ä»¶è¿›è¡Œåˆ†è¯ã€‚</p>
<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"472"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">472</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">25571</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Lee"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Long"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"288 Mill Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Comverges"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"leelong@comverges.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Movico"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"MT"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="ï¼ˆ6ï¼‰boolç”¨æ¥åšå¤åˆæŸ¥è¯¢"><a href="#ï¼ˆ6ï¼‰boolç”¨æ¥åšå¤åˆæŸ¥è¯¢" class="headerlink" title="ï¼ˆ6ï¼‰boolç”¨æ¥åšå¤åˆæŸ¥è¯¢"></a>ï¼ˆ6ï¼‰boolç”¨æ¥åšå¤åˆæŸ¥è¯¢</h5><p>å¤åˆè¯­å¥å¯ä»¥åˆå¹¶ï¼Œä»»ä½•å…¶ä»–æŸ¥è¯¢è¯­å¥ï¼ŒåŒ…æ‹¬ç¬¦åˆè¯­å¥ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå¤åˆè¯­å¥ä¹‹é—´<br>å¯ä»¥äº’ç›¸åµŒå¥—ï¼Œå¯ä»¥è¡¨è¾¾éå¸¸å¤æ‚çš„é€»è¾‘ã€‚</p>
<p>mustï¼šå¿…é¡»è¾¾åˆ°mustæ‰€åˆ—ä¸¾çš„æ‰€æœ‰æ¡ä»¶</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
   <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"bool"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
             <span class="token property">"must"</span><span class="token operator">:</span><span class="token punctuation">[</span>
              <span class="token punctuation">&#123;</span><span class="token property">"match"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"address"</span><span class="token operator">:</span><span class="token string">"mill"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
              <span class="token punctuation">&#123;</span><span class="token property">"match"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"gender"</span><span class="token operator">:</span><span class="token string">"M"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
             <span class="token punctuation">]</span>
         <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>must_notï¼Œå¿…é¡»ä¸åŒ¹é…must_notæ‰€åˆ—ä¸¾çš„æ‰€æœ‰æ¡ä»¶ã€‚</p>
<p>shouldï¼Œåº”è¯¥æ»¡è¶³shouldæ‰€åˆ—ä¸¾çš„æ¡ä»¶ã€‚</p>
<p>å®ä¾‹ï¼šæŸ¥è¯¢gender=mï¼Œå¹¶ä¸”address=millçš„æ•°æ®</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p><strong>must_notï¼šå¿…é¡»ä¸æ˜¯æŒ‡å®šçš„æƒ…å†µ</strong></p>
<p>å®ä¾‹ï¼šæŸ¥è¯¢gender=mï¼Œå¹¶ä¸”address=millçš„æ•°æ®ï¼Œä½†æ˜¯ageä¸ç­‰äº38çš„</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">
GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"must_not"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"age"</span><span class="token operator">:</span> <span class="token string">"38"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p><strong>shouldï¼šåº”è¯¥è¾¾åˆ°shouldåˆ—ä¸¾çš„æ¡ä»¶ï¼Œå¦‚æœåˆ°è¾¾ä¼šå¢åŠ ç›¸å…³æ–‡æ¡£çš„è¯„åˆ†ï¼Œå¹¶ä¸ä¼šæ”¹å˜æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœqueryä¸­åªæœ‰shouldä¸”åªæœ‰ä¸€ç§åŒ¹é…è§„åˆ™ï¼Œé‚£ä¹ˆshouldçš„æ¡ä»¶å°±ä¼šè¢«ä½œä¸ºé»˜è®¤åŒ¹é…æ¡ä»¶äºŒåŒºæ”¹å˜æŸ¥è¯¢ç»“æœã€‚</strong></p>
<p>å®ä¾‹ï¼šåŒ¹é…lastNameåº”è¯¥ç­‰äºWallaceçš„æ•°æ®</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"must_not"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"age"</span><span class="token operator">:</span> <span class="token string">"18"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"should"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"lastname"</span><span class="token operator">:</span> <span class="token string">"Wallace"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">12.585751</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">12.585751</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.0824604</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>èƒ½å¤Ÿçœ‹åˆ°ç›¸å…³åº¦è¶Šé«˜ï¼Œå¾—åˆ†ä¹Ÿè¶Šé«˜ã€‚</p>
<h5 id="ï¼ˆ7ï¼‰Filterã€ç»“æœè¿‡æ»¤ã€‘"><a href="#ï¼ˆ7ï¼‰Filterã€ç»“æœè¿‡æ»¤ã€‘" class="headerlink" title="ï¼ˆ7ï¼‰Filterã€ç»“æœè¿‡æ»¤ã€‘"></a>ï¼ˆ7ï¼‰Filterã€ç»“æœè¿‡æ»¤ã€‘</h5><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æŸ¥è¯¢éƒ½éœ€è¦äº§ç”Ÿåˆ†æ•°ï¼Œç‰¹åˆ«æ˜¯å“ªäº›ä»…ç”¨äºfilteringè¿‡æ»¤çš„æ–‡æ¡£ã€‚ä¸ºäº†ä¸è®¡ç®—åˆ†æ•°ï¼Œelasticsearchä¼šè‡ªåŠ¨æ£€æŸ¥åœºæ™¯å¹¶ä¸”ä¼˜åŒ–æŸ¥è¯¢çš„æ‰§è¡Œã€‚</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"range"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"balance"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"gte"</span><span class="token operator">:</span> <span class="token string">"10000"</span><span class="token punctuation">,</span>
            <span class="token property">"lte"</span><span class="token operator">:</span> <span class="token string">"20000"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œå…ˆæ˜¯æŸ¥è¯¢æ‰€æœ‰åŒ¹é…address=millçš„æ–‡æ¡£ï¼Œç„¶åå†æ ¹æ®10000&lt;=balance&lt;=20000è¿›è¡Œè¿‡æ»¤æŸ¥è¯¢ç»“æœ</p>
<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4032025</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>Each <code>must</code>, <code>should</code>, and <code>must_not</code> element in a Boolean query is referred to as a query clause. How well a document meets the criteria in each <code>must</code> or <code>should</code> clause contributes to the documentâ€™s <em>relevance score</em>. The higher the score, the better the document matches your search criteria. By default, Elasticsearch returns documents ranked by these relevance scores.</p>
<p> åœ¨booleanæŸ¥è¯¢ä¸­ï¼Œ<code>must</code>, <code>should</code> å’Œ<code>must_not</code> å…ƒç´ éƒ½è¢«ç§°ä¸ºæŸ¥è¯¢å­å¥ ã€‚ æ–‡æ¡£æ˜¯å¦ç¬¦åˆæ¯ä¸ªâ€œmustâ€æˆ–â€œshouldâ€å­å¥ä¸­çš„æ ‡å‡†ï¼Œå†³å®šäº†æ–‡æ¡£çš„â€œç›¸å…³æ€§å¾—åˆ†â€ã€‚  å¾—åˆ†è¶Šé«˜ï¼Œæ–‡æ¡£è¶Šç¬¦åˆæ‚¨çš„æœç´¢æ¡ä»¶ã€‚  é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchè¿”å›æ ¹æ®è¿™äº›ç›¸å…³æ€§å¾—åˆ†æ’åºçš„æ–‡æ¡£ã€‚ </p>
<p>The criteria in a <code>must_not</code> clause is treated as a <em>filter</em>. It affects whether or not the document is included in the results, but does not contribute to how documents are scored. You can also explicitly specify arbitrary filters to include or exclude documents based on structured data.</p>
<p><code>â€œmust_notâ€å­å¥ä¸­çš„æ¡ä»¶è¢«è§†ä¸ºâ€œè¿‡æ»¤å™¨â€ã€‚</code> å®ƒå½±å“æ–‡æ¡£æ˜¯å¦åŒ…å«åœ¨ç»“æœä¸­ï¼Œ  ä½†ä¸å½±å“æ–‡æ¡£çš„è¯„åˆ†æ–¹å¼ã€‚  è¿˜å¯ä»¥æ˜¾å¼åœ°æŒ‡å®šä»»æ„è¿‡æ»¤å™¨æ¥åŒ…å«æˆ–æ’é™¤åŸºäºç»“æ„åŒ–æ•°æ®çš„æ–‡æ¡£ã€‚ </p>
<p>filteråœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸ä¼šè®¡ç®—ç›¸å…³æ€§å¾—åˆ†ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"range"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"balance"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"gte"</span><span class="token operator">:</span> <span class="token string">"10000"</span><span class="token punctuation">,</span>
            <span class="token property">"lte"</span><span class="token operator">:</span> <span class="token string">"20000"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">213</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16418</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Elinor"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Ratliff"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"282 Kings Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Scentric"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"elinorratliff@scentric.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Ribera"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"WA"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"37"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">18612</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Mcgee"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Mooney"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"826 Fillmore Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Reversus"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"mcgeemooney@reversus.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Tooleville"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"OK"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"51"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">14097</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Burton"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Meyers"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"334 River Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Bezal"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"burtonmeyers@bezal.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Jacksonburg"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"MO"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"56"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">56</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">14992</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Josie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Nelson"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"857 Tabor Court"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Emtrac"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"josienelson@emtrac.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Sunnyside"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"UT"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"121"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">121</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19594</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Acevedo"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Dorsey"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"479 Nova Court"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Netropic"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"acevedodorsey@netropic.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Islandia"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"CT"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"176"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">176</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">18607</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Kemp"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Walters"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"906 Howard Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Eyewax"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"kempwalters@eyewax.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Why"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"183"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">183</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">14223</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Hudson"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"English"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"823 Herkimer Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Xinware"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"hudsonenglish@xinware.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Robbins"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"ND"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">222</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">14764</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Rachelle"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Rice"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"333 Narrows Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Enaut"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"rachellerice@enaut.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Wright"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AZ"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"227"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">227</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19780</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Coleman"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Berg"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"776 Little Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Exoteric"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"colemanberg@exoteric.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Eagleville"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"WV"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"272"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">272</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19253</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Lilly"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Morgan"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"689 Fleet Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Biolive"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"lillymorgan@biolive.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Sunbury"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"OH"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>èƒ½çœ‹åˆ°æ‰€æœ‰æ–‡æ¡£çš„ â€œ_scoreâ€ : 0.0ã€‚</strong></p>
<h5 id="ï¼ˆ8ï¼‰term"><a href="#ï¼ˆ8ï¼‰term" class="headerlink" title="ï¼ˆ8ï¼‰term"></a>ï¼ˆ8ï¼‰term</h5><p>å’Œmatchä¸€æ ·ã€‚åŒ¹é…æŸä¸ªå±æ€§çš„å€¼ã€‚å…¨æ–‡æ£€ç´¢å­—æ®µç”¨matchï¼Œå…¶ä»–étextå­—æ®µåŒ¹é…ç”¨termã€‚</p>
<blockquote>
<p>Avoid using the <code>term</code> query for <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/text.html"><code>text</code></a> fields.</p>
<p>é¿å…å¯¹æ–‡æœ¬å­—æ®µä½¿ç”¨â€œtermâ€æŸ¥è¯¢</p>
<p>By default, Elasticsearch changes the values of <code>text</code> fields as part of <a href="">analysis</a>. This can make finding exact matches for <code>text</code> field values difficult.</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchä½œä¸º<a href="">analysis</a>çš„ä¸€éƒ¨åˆ†æ›´æ”¹â€™ text â€˜å­—æ®µçš„å€¼ã€‚è¿™ä½¿å¾—ä¸ºâ€œtextâ€å­—æ®µå€¼å¯»æ‰¾ç²¾ç¡®åŒ¹é…å˜å¾—å›°éš¾ã€‚ </p>
<p>To search <code>text</code> field values, use the match.</p>
<p>è¦æœç´¢â€œtextâ€å­—æ®µå€¼ï¼Œè¯·ä½¿ç”¨åŒ¹é…ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html</a> </p>
</blockquote>
<p>ä½¿ç”¨termåŒ¹é…æŸ¥è¯¢</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"term"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill Road"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€æ¡ä¹Ÿæ²¡æœ‰åŒ¹é…åˆ°</p>
<p>è€Œæ›´æ¢ä¸ºmatchåŒ¹é…æ—¶ï¼Œèƒ½å¤ŸåŒ¹é…åˆ°32ä¸ªæ–‡æ¡£</p>
<p><img src="/img/spring-cloud/image-20200502120921830.png" alt="image-20200502120921830"></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å…¨æ–‡æ£€ç´¢å­—æ®µç”¨matchï¼Œå…¶ä»–étextå­—æ®µåŒ¹é…ç”¨term</strong>ã€‚</p>
<h5 id="ï¼ˆ9ï¼‰Aggregationï¼ˆæ‰§è¡Œèšåˆï¼‰"><a href="#ï¼ˆ9ï¼‰Aggregationï¼ˆæ‰§è¡Œèšåˆï¼‰" class="headerlink" title="ï¼ˆ9ï¼‰Aggregationï¼ˆæ‰§è¡Œèšåˆï¼‰"></a>ï¼ˆ9ï¼‰Aggregationï¼ˆæ‰§è¡Œèšåˆï¼‰</h5><p>èšåˆæä¾›äº†ä»æ•°æ®ä¸­åˆ†ç»„å’Œæå–æ•°æ®çš„èƒ½åŠ›ã€‚æœ€ç®€å•çš„èšåˆæ–¹æ³•å¤§è‡´ç­‰äºSQL Group byå’ŒSQLèšåˆå‡½æ•°ã€‚åœ¨elasticsearchä¸­ï¼Œæ‰§è¡Œæœç´¢è¿”å›thisï¼ˆå‘½ä¸­ç»“æœï¼‰ï¼Œå¹¶ä¸”åŒæ—¶è¿”å›èšåˆç»“æœï¼ŒæŠŠä»¥å“åº”ä¸­çš„æ‰€æœ‰hitsï¼ˆå‘½ä¸­ç»“æœï¼‰åˆ†éš”å¼€çš„èƒ½åŠ›ã€‚è¿™æ˜¯éå¸¸å¼ºå¤§ä¸”æœ‰æ•ˆçš„ï¼Œä½ å¯ä»¥æ‰§è¡ŒæŸ¥è¯¢å’Œå¤šä¸ªèšåˆï¼Œå¹¶ä¸”åœ¨ä¸€æ¬¡ä½¿ç”¨ä¸­å¾—åˆ°å„è‡ªçš„ï¼ˆä»»ä½•ä¸€ä¸ªçš„ï¼‰è¿”å›ç»“æœï¼Œä½¿ç”¨ä¸€æ¬¡ç®€æ´å’Œç®€åŒ–çš„APIå•¦é¿å…ç½‘ç»œå¾€è¿”ã€‚</p>
<p>â€œsizeâ€:0</p>
<p>size:0ä¸æ˜¾ç¤ºæœç´¢æ•°æ®<br>aggsï¼šæ‰§è¡Œèšåˆã€‚èšåˆè¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"aggs"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
    <span class="token property">"aggs_nameè¿™æ¬¡èšåˆçš„åå­—ï¼Œæ–¹ä¾¿å±•ç¤ºåœ¨ç»“æœé›†ä¸­"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"AGG_TYPEèšåˆçš„ç±»å‹(avg,term,terms)"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
     <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>ï¼Œ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<p><strong>æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œä½†ä¸æ˜¾ç¤ºè¿™äº›äººçš„è¯¦æƒ…</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"Mill"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">10</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"ageAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"balanceAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥è¯¢ç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggregations"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"doc_count_error_upper_bound"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"sum_other_doc_count"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"buckets"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">34.0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"balanceAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">25208.0</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p>å¤æ‚ï¼š<br>æŒ‰ç…§å¹´é¾„èšåˆï¼Œå¹¶ä¸”æ±‚è¿™äº›å¹´é¾„æ®µçš„è¿™äº›äººçš„å¹³å‡è–ªèµ„</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"ageAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggregations"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"doc_count_error_upper_bound"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"sum_other_doc_count"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"buckets"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28312.918032786885</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">25269.583333333332</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">23194.813559322032</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">23951.346153846152</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">22136.69230769231</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">22174.71153846154</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">24731.07843137255</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28273.882352941175</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">33</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">25093.94</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26809.95918367347</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">47</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">22841.106382978724</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">46</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26981.434782608696</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27183.17777777778</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">44</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27741.227272727272</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27314.214285714286</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28519.04761904762</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27445.214285714286</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27022.261904761905</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">21471.871794871793</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26187.17948717949</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">29483.14285714286</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥å‡ºæ‰€æœ‰å¹´é¾„åˆ†å¸ƒï¼Œå¹¶ä¸”è¿™äº›å¹´é¾„æ®µä¸­Mçš„å¹³å‡è–ªèµ„å’ŒFçš„å¹³å‡è–ªèµ„ä»¥åŠè¿™ä¸ªå¹´é¾„æ®µçš„æ€»ä½“å¹³å‡è–ªèµ„</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"genderAgg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"terms"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"gender.keyword"</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
          <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"balanceAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
              <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"ageBalanceAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">119</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggregations"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"doc_count_error_upper_bound"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"sum_other_doc_count"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"buckets"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
          <span class="token property">"genderAgg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"doc_count_error_upper_bound"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"sum_other_doc_count"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"buckets"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">&#123;</span>
                <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
                <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
                <span class="token property">"balanceAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                  <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">29565.628571428573</span>
                <span class="token punctuation">&#125;</span>
              <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
              <span class="token punctuation">&#123;</span>
                <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
                <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
                <span class="token property">"balanceAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                  <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26626.576923076922</span>
                <span class="token punctuation">&#125;</span>
              <span class="token punctuation">&#125;</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
          <span class="token property">"ageBalanceAvg"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28312.918032786885</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">]</span>
        .......<span class="token comment">//çœç•¥å…¶ä»–</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3ï¼‰Mapping"><a href="#3ï¼‰Mapping" class="headerlink" title="3ï¼‰Mapping"></a>3ï¼‰Mapping</h4><h5 id="ï¼ˆ1ï¼‰å­—æ®µç±»å‹"><a href="#ï¼ˆ1ï¼‰å­—æ®µç±»å‹" class="headerlink" title="ï¼ˆ1ï¼‰å­—æ®µç±»å‹"></a>ï¼ˆ1ï¼‰å­—æ®µç±»å‹</h5><p><img src="/img/spring-cloud/image-20200502161339291.png" alt="image-20200502161339291"></p>
<h5 id="ï¼ˆ2ï¼‰æ˜ å°„"><a href="#ï¼ˆ2ï¼‰æ˜ å°„" class="headerlink" title="ï¼ˆ2ï¼‰æ˜ å°„"></a>ï¼ˆ2ï¼‰æ˜ å°„</h5><p>Mapping(æ˜ å°„)<br>Mapingæ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–‡æ¡£ï¼ˆdocumentï¼‰ï¼Œä»¥åŠå®ƒæ‰€åŒ…å«çš„å±æ€§ï¼ˆfieldï¼‰æ˜¯å¦‚ä½•å­˜å‚¨å’Œç´¢å¼•çš„ã€‚æ¯”å¦‚ï¼šä½¿ç”¨mapingæ¥å®šä¹‰ï¼š</p>
<ul>
<li><p>å“ªäº›å­—ç¬¦ä¸²å±æ€§åº”è¯¥è¢«çœ‹åšå…¨æ–‡æœ¬å±æ€§ï¼ˆfull text fieldsï¼‰ï¼›</p>
</li>
<li><p>å“ªäº›å±æ€§åŒ…å«æ•°å­—ï¼Œæ—¥æœŸæˆ–åœ°ç†ä½ç½®ï¼›</p>
</li>
<li><p>æ–‡æ¡£ä¸­çš„æ‰€æœ‰å±æ€§æ˜¯å¦éƒ½å«©è¢«ç´¢å¼•ï¼ˆall é…ç½®ï¼‰ï¼›</p>
</li>
<li><p>æ—¥æœŸçš„æ ¼å¼ï¼›</p>
</li>
<li><p>è‡ªå®šä¹‰æ˜ å°„è§„åˆ™æ¥æ‰§è¡ŒåŠ¨æ€æ·»åŠ å±æ€§ï¼›</p>
</li>
<li><p>æŸ¥çœ‹mappingä¿¡æ¯<br>GET bank/_mapping</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"bank"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"mappings"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"properties"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"long"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"long"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"long"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
          <span class="token property">"fields"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"keyword"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
              <span class="token property">"ignore_above"</span> <span class="token operator">:</span> <span class="token number">256</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>ä¿®æ”¹mappingä¿¡æ¯</p>
</li>
</ul>
<p><img src="/img/spring-cloud/image-20200502170924399.png" alt="image-20200502170924399"></p>
<h5 id="ï¼ˆ3ï¼‰æ–°ç‰ˆæœ¬æ”¹å˜"><a href="#ï¼ˆ3ï¼‰æ–°ç‰ˆæœ¬æ”¹å˜" class="headerlink" title="ï¼ˆ3ï¼‰æ–°ç‰ˆæœ¬æ”¹å˜"></a>ï¼ˆ3ï¼‰æ–°ç‰ˆæœ¬æ”¹å˜</h5><p>ElasticSearch7-å»æ‰typeæ¦‚å¿µ</p>
<ol>
<li><p>å…³ç³»å‹æ•°æ®åº“ä¸­ä¸¤ä¸ªæ•°æ®è¡¨ç¤ºæ˜¯ç‹¬ç«‹çš„ï¼Œå³ä½¿ä»–ä»¬é‡Œé¢æœ‰ç›¸åŒåç§°çš„åˆ—ä¹Ÿä¸å½±å“ä½¿ç”¨ï¼Œä½†ESä¸­ä¸æ˜¯è¿™æ ·çš„ã€‚elasticsearchæ˜¯åŸºäºLuceneå¼€å‘çš„æœç´¢å¼•æ“ï¼Œè€ŒESä¸­ä¸åŒtypeä¸‹åç§°ç›¸åŒçš„filedæœ€ç»ˆåœ¨Luceneä¸­çš„å¤„ç†æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚</p>
<ul>
<li>ä¸¤ä¸ªä¸åŒtypeä¸‹çš„ä¸¤ä¸ªuser_nameï¼Œåœ¨ESåŒä¸€ä¸ªç´¢å¼•ä¸‹å…¶å®è¢«è®¤ä¸ºæ˜¯åŒä¸€ä¸ªfiledï¼Œä½ å¿…é¡»åœ¨ä¸¤ä¸ªä¸åŒçš„typeä¸­å®šä¹‰ç›¸åŒçš„filedæ˜ å°„ã€‚å¦åˆ™ï¼Œä¸åŒtypeä¸­çš„ç›¸åŒå­—æ®µåç§°å°±ä¼šåœ¨å¤„ç†ä¸­å‡ºç°å†²çªçš„æƒ…å†µï¼Œå¯¼è‡´Luceneå¤„ç†æ•ˆç‡ä¸‹é™ã€‚</li>
<li>å»æ‰typeå°±æ˜¯ä¸ºäº†æé«˜ESå¤„ç†æ•°æ®çš„æ•ˆç‡ã€‚</li>
</ul>
</li>
<li><p>Elasticsearch 7.x URLä¸­çš„typeå‚æ•°ä¸ºå¯é€‰ã€‚æ¯”å¦‚ï¼Œç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ä¸å†è¦æ±‚æä¾›æ–‡æ¡£ç±»å‹ã€‚</p>
</li>
<li><p>Elasticsearch 8.x ä¸å†æ”¯æŒURLä¸­çš„typeå‚æ•°ã€‚</p>
</li>
<li><p>è§£å†³ï¼š<br>å°†ç´¢å¼•ä»å¤šç±»å‹è¿ç§»åˆ°å•ç±»å‹ï¼Œæ¯ç§ç±»å‹æ–‡æ¡£ä¸€ä¸ªç‹¬ç«‹ç´¢å¼•</p>
<p>å°†å·²å­˜åœ¨çš„ç´¢å¼•ä¸‹çš„ç±»å‹æ•°æ®ï¼Œå…¨éƒ¨è¿ç§»åˆ°æŒ‡å®šä½ç½®å³å¯ã€‚è¯¦è§æ•°æ®è¿ç§»</p>
</li>
</ol>
<blockquote>
<p><strong>Elasticsearch 7.x</strong></p>
<ul>
<li>Specifying types in requests is deprecated. For instance, indexing a document no longer requires a document <code>type</code>. The new index APIs are <code>PUT &#123;index&#125;/_doc/&#123;id&#125;</code> in case of explicit ids and <code>POST &#123;index&#125;/_doc</code> for auto-generated ids. Note that in 7.0, <code>_doc</code> is a permanent part of the path, and represents the endpoint name rather than the document type.</li>
<li>The <code>include_type_name</code> parameter in the index creation, index template, and mapping APIs will default to <code>false</code>. Setting the parameter at all will result in a deprecation warning.</li>
<li>The <code>_default_</code> mapping type is removed.</li>
</ul>
<p><strong>Elasticsearch 8.x</strong></p>
<ul>
<li>Specifying types in requests is no longer supported.</li>
<li>The <code>include_type_name</code> parameter is removed.</li>
</ul>
</blockquote>
<h6 id="åˆ›å»ºæ˜ å°„"><a href="#åˆ›å»ºæ˜ å°„" class="headerlink" title="åˆ›å»ºæ˜ å°„"></a>åˆ›å»ºæ˜ å°„</h6><p>åˆ›å»ºç´¢å¼•å¹¶æŒ‡å®šæ˜ å°„</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">PUT /my_index
<span class="token punctuation">&#123;</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"age"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"email"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> è¾“å‡ºï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"acknowledged"</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"shards_acknowledged"</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token string">"my_index"</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="æŸ¥çœ‹æ˜ å°„"><a href="#æŸ¥çœ‹æ˜ å°„" class="headerlink" title="æŸ¥çœ‹æ˜ å°„"></a>æŸ¥çœ‹æ˜ å°„</h6><pre class="line-numbers language-json" data-language="json"><code class="language-json">GET /my_index<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"my_index"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"aliases"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"mappings"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"properties"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"integer"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"employee-id"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
          <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"name"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"text"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"settings"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"creation_date"</span> <span class="token operator">:</span> <span class="token string">"1588410780774"</span><span class="token punctuation">,</span>
        <span class="token property">"number_of_shards"</span> <span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"number_of_replicas"</span> <span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"uuid"</span> <span class="token operator">:</span> <span class="token string">"ua0lXhtkQCOmn7Kh3iUu0w"</span><span class="token punctuation">,</span>
        <span class="token property">"version"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"created"</span> <span class="token operator">:</span> <span class="token string">"7060299"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"provided_name"</span> <span class="token operator">:</span> <span class="token string">"my_index"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h6 id="æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„"><a href="#æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„" class="headerlink" title="æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„"></a>æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„</h6><pre class="line-numbers language-json" data-language="json"><code class="language-json">PUT /my_index/_mapping
<span class="token punctuation">&#123;</span>
  <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"employee-id"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
      <span class="token property">"index"</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œçš„ â€œindexâ€: falseï¼Œè¡¨æ˜æ–°å¢çš„å­—æ®µä¸èƒ½è¢«æ£€ç´¢ï¼Œåªæ˜¯ä¸€ä¸ªå†—ä½™å­—æ®µã€‚</p>
<h6 id="æ›´æ–°æ˜ å°„"><a href="#æ›´æ–°æ˜ å°„" class="headerlink" title="æ›´æ–°æ˜ å°„"></a>æ›´æ–°æ˜ å°„</h6><p>å¯¹äºå·²ç»å­˜åœ¨çš„å­—æ®µæ˜ å°„ï¼Œæˆ‘ä»¬ä¸èƒ½æ›´æ–°ã€‚æ›´æ–°å¿…é¡»åˆ›å»ºæ–°çš„ç´¢å¼•ï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚</p>
<h6 id="æ•°æ®è¿ç§»"><a href="#æ•°æ®è¿ç§»" class="headerlink" title="æ•°æ®è¿ç§»"></a>æ•°æ®è¿ç§»</h6><p>å…ˆåˆ›å»ºnew_twitterçš„æ­£ç¡®æ˜ å°„ã€‚ç„¶åä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ•°æ®è¿ç§»ã€‚</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST reindex <span class="token punctuation">[</span>å›ºå®šå†™æ³•<span class="token punctuation">]</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"source"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span><span class="token operator">:</span><span class="token string">"twitter"</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"dest"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span><span class="token operator">:</span><span class="token string">"new_twitters"</span>
   <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>å°†æ—§ç´¢å¼•çš„typeä¸‹çš„æ•°æ®è¿›è¡Œè¿ç§»</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST reindex <span class="token punctuation">[</span>å›ºå®šå†™æ³•<span class="token punctuation">]</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"source"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span><span class="token operator">:</span><span class="token string">"twitter"</span><span class="token punctuation">,</span>
      <span class="token property">"twitter"</span><span class="token operator">:</span><span class="token string">"twitter"</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"dest"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
      <span class="token property">"index"</span><span class="token operator">:</span><span class="token string">"new_twitters"</span>
   <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ›´å¤šè¯¦æƒ…è§ï¼š <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/docs-reindex.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/docs-reindex.html</a> </p>
<p>GET /bank/_search</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span><span class="token comment">//ç±»å‹ä¸ºaccount</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">39225</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Amber"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Duke"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"880 Holmes Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pyrami"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"amberduke@pyrami.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Brogan"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      ...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none">GET &#x2F;bank&#x2F;_search<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/img/spring-cloud/image-20200502174825233.png" alt="image-20200502174825233"></p>
<p>æƒ³è¦å°†å¹´é¾„ä¿®æ”¹ä¸ºinteger</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">PUT /newbank
<span class="token punctuation">&#123;</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"age"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"balance"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"city"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"email"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"employer"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"firstname"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"lastname"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
        <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>
            <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"state"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥çœ‹â€œnewbankâ€çš„æ˜ å°„ï¼š</p>
<p>GET /newbank/_mapping</p>
<p><img src="/img/spring-cloud/image-20200502175901959.png" alt="image-20200502175901959"></p>
<p>èƒ½å¤Ÿçœ‹åˆ°ageçš„æ˜ å°„ç±»å‹è¢«ä¿®æ”¹ä¸ºäº†integer.</p>
<p>å°†bankä¸­çš„æ•°æ®è¿ç§»åˆ°newbankä¸­</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST _reindex
<span class="token punctuation">&#123;</span>
  <span class="token property">"source"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"index"</span><span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"account"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"dest"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"index"</span><span class="token operator">:</span> <span class="token string">"newbank"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œè¾“å‡ºï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">#! Deprecation<span class="token operator">:</span> <span class="token punctuation">[</span>types removal<span class="token punctuation">]</span> Specifying types in reindex requests is deprecated.
<span class="token punctuation">&#123;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">768</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token property">"updated"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"created"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token property">"deleted"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"batches"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"version_conflicts"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"noops"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"retries"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"bulk"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"search"</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"throttled_millis"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"requests_per_second"</span> <span class="token operator">:</span> <span class="token number">-1.0</span><span class="token punctuation">,</span>
  <span class="token property">"throttled_until_millis"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"failures"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æŸ¥çœ‹newbankä¸­çš„æ•°æ®</p>
<p><img src="/img/spring-cloud/image-20200502181432745.png" alt="image-20200502181432745"></p>
<h4 id="4ï¼‰åˆ†è¯"><a href="#4ï¼‰åˆ†è¯" class="headerlink" title="4ï¼‰åˆ†è¯"></a>4ï¼‰åˆ†è¯</h4><p>ä¸€ä¸ªtokenizerï¼ˆåˆ†è¯å™¨ï¼‰æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµï¼Œå°†ä¹‹åˆ†å‰²ä¸ºç‹¬ç«‹çš„tokensï¼ˆè¯å…ƒï¼Œé€šå¸¸æ˜¯ç‹¬ç«‹çš„å•è¯ï¼‰ï¼Œç„¶åè¾“å‡ºtokensæµã€‚</p>
<p>ä¾‹å¦‚ï¼šwhitespace tokenizeré‡åˆ°ç©ºç™½å­—ç¬¦æ—¶åˆ†å‰²æ–‡æœ¬ã€‚å®ƒä¼šå°†æ–‡æœ¬â€œQuick brown fox!â€åˆ†å‰²ä¸º[Quick,brown,fox!]ã€‚</p>
<p>è¯¥tokenizerï¼ˆåˆ†è¯å™¨ï¼‰è¿˜è´Ÿè´£è®°å½•å„ä¸ªterms(è¯æ¡)çš„é¡ºåºæˆ–positionä½ç½®ï¼ˆç”¨äºphraseçŸ­è¯­å’Œword proximityè¯è¿‘é‚»æŸ¥è¯¢ï¼‰ï¼Œä»¥åŠtermï¼ˆè¯æ¡ï¼‰æ‰€ä»£è¡¨çš„åŸå§‹wordï¼ˆå•è¯ï¼‰çš„startï¼ˆèµ·å§‹ï¼‰å’Œendï¼ˆç»“æŸï¼‰çš„character offsetsï¼ˆå­—ç¬¦ä¸²åç§»é‡ï¼‰ï¼ˆç”¨äºé«˜äº®æ˜¾ç¤ºæœç´¢çš„å†…å®¹ï¼‰ã€‚</p>
<p>elasticsearchæä¾›äº†å¾ˆå¤šå†…ç½®çš„åˆ†è¯å™¨ï¼Œå¯ä»¥ç”¨æ¥æ„å»ºcustom analyzersï¼ˆè‡ªå®šä¹‰åˆ†è¯å™¨ï¼‰ã€‚</p>
<p>å…³äºåˆ†è¯å™¨ï¼š <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/analysis.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/analysis.html</a> </p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST _analyze
<span class="token punctuation">&#123;</span>
  <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"standard"</span><span class="token punctuation">,</span>
  <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"The 2 QUICK Brown-Foxes jumped over the lazy dog's bone."</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰§è¡Œç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"tokens"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"the"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;NUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"quick"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"brown"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"foxes"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">4</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"jumped"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"over"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">6</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"the"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">7</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"lazy"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">44</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">8</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"dog's"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">9</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"bone"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">55</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;ALPHANUM>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="ï¼ˆ1ï¼‰å®‰è£…ikåˆ†è¯å™¨"><a href="#ï¼ˆ1ï¼‰å®‰è£…ikåˆ†è¯å™¨" class="headerlink" title="ï¼ˆ1ï¼‰å®‰è£…ikåˆ†è¯å™¨"></a>ï¼ˆ1ï¼‰å®‰è£…ikåˆ†è¯å™¨</h5><p><img src="/img/spring-cloud/image-20200502182929583.png" alt="image-20200502182929583"></p>
<p>æ‰€æœ‰çš„è¯­è¨€åˆ†è¯ï¼Œé»˜è®¤ä½¿ç”¨çš„éƒ½æ˜¯â€œStandard Analyzerâ€ï¼Œä½†æ˜¯è¿™äº›åˆ†è¯å™¨é’ˆå¯¹äºä¸­æ–‡çš„åˆ†è¯ï¼Œå¹¶ä¸å‹å¥½ã€‚ä¸ºæ­¤éœ€è¦å®‰è£…ä¸­æ–‡çš„åˆ†è¯å™¨ã€‚</p>
<p>æ³¨æ„ï¼šä¸èƒ½ç”¨é»˜è®¤elasticsearch-plugin install xxx.zip è¿›è¡Œè‡ªåŠ¨å®‰è£…<br><a target="_blank" rel="noopener" href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download">https://github.com/medcl/elasticsearch-analysis-ik/releases/download</a> å¯¹åº”esç‰ˆæœ¬å®‰è£…</p>
<p>åœ¨å‰é¢å®‰è£…çš„elasticsearchæ—¶ï¼Œæˆ‘ä»¬å·²ç»å°†elasticsearchå®¹å™¨çš„â€œ/usr/share/elasticsearch/pluginsâ€ç›®å½•ï¼Œæ˜ å°„åˆ°å®¿ä¸»æœºçš„â€œ /mydata/elasticsearch/pluginsâ€ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„åšæ³•å°±æ˜¯ä¸‹è½½â€œ/elasticsearch-analysis-ik-7.6.2.zipâ€æ–‡ä»¶ï¼Œç„¶åè§£å‹åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹å³å¯ã€‚å®‰è£…å®Œæ¯•åï¼Œéœ€è¦é‡å¯elasticsearchå®¹å™¨ã€‚</p>
<p>å¦‚æœä¸å«Œéº»çƒ¦ï¼Œè¿˜å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ–¹å¼ã€‚</p>
<h6 id="ï¼ˆ1ï¼‰æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·ï¼š"><a href="#ï¼ˆ1ï¼‰æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·ï¼š"></a>ï¼ˆ1ï¼‰æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·ï¼š</h6><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@hadoop-104 ~<span class="token punctuation">]</span><span class="token comment"># curl http://localhost:9200</span>
<span class="token punctuation">&#123;</span>
  <span class="token string">"name"</span> <span class="token builtin class-name">:</span> <span class="token string">"0adeb7852e00"</span>,
  <span class="token string">"cluster_name"</span> <span class="token builtin class-name">:</span> <span class="token string">"elasticsearch"</span>,
  <span class="token string">"cluster_uuid"</span> <span class="token builtin class-name">:</span> <span class="token string">"9gglpP0HTfyOTRAaSe2rIg"</span>,
  <span class="token string">"version"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"number"</span> <span class="token builtin class-name">:</span> <span class="token string">"7.6.2"</span>,      <span class="token comment">#ç‰ˆæœ¬å·ä¸º7.6.2</span>
    <span class="token string">"build_flavor"</span> <span class="token builtin class-name">:</span> <span class="token string">"default"</span>,
    <span class="token string">"build_type"</span> <span class="token builtin class-name">:</span> <span class="token string">"docker"</span>,
    <span class="token string">"build_hash"</span> <span class="token builtin class-name">:</span> <span class="token string">"ef48eb35cf30adf4db14086e8aabd07ef6fb113f"</span>,
    <span class="token string">"build_date"</span> <span class="token builtin class-name">:</span> <span class="token string">"2020-03-26T06:34:37.794943Z"</span>,
    <span class="token string">"build_snapshot"</span> <span class="token builtin class-name">:</span> false,
    <span class="token string">"lucene_version"</span> <span class="token builtin class-name">:</span> <span class="token string">"8.4.0"</span>,
    <span class="token string">"minimum_wire_compatibility_version"</span> <span class="token builtin class-name">:</span> <span class="token string">"6.8.0"</span>,
    <span class="token string">"minimum_index_compatibility_version"</span> <span class="token builtin class-name">:</span> <span class="token string">"6.0.0-beta1"</span>
  <span class="token punctuation">&#125;</span>,
  <span class="token string">"tagline"</span> <span class="token builtin class-name">:</span> <span class="token string">"You Know, for Search"</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">[</span>root@hadoop-104 ~<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="ï¼ˆ2ï¼‰è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•"><a href="#ï¼ˆ2ï¼‰è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•" class="headerlink" title="ï¼ˆ2ï¼‰è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•"></a>ï¼ˆ2ï¼‰è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•</h6><ul>
<li>docker exec -it å®¹å™¨id /bin/bash</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@hadoop-104 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it elasticsearch /bin/bash</span>
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>wget  <a target="_blank" rel="noopener" href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip">https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip</a></li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/usr/share/elasticsearch
<span class="token comment">#ä¸‹è½½ik7.6.2</span>
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># wget https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>unzip ä¸‹è½½çš„æ–‡ä»¶</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># unzip elasticsearch-analysis-ik-7.6.2.zip -d ink</span>
Archive:  elasticsearch-analysis-ik-7.6.2.zip
   creating: ik/config/
  inflating: ik/config/main.dic      
  inflating: ik/config/quantifier.dic  
  inflating: ik/config/extra_single_word_full.dic  
  inflating: ik/config/IKAnalyzer.cfg.xml  
  inflating: ik/config/surname.dic   
  inflating: ik/config/suffix.dic    
  inflating: ik/config/stopword.dic  
  inflating: ik/config/extra_main.dic  
  inflating: ik/config/extra_stopword.dic  
  inflating: ik/config/preposition.dic  
  inflating: ik/config/extra_single_word_low_freq.dic  
  inflating: ik/config/extra_single_word.dic  
  inflating: ik/elasticsearch-analysis-ik-7.6.2.jar  
  inflating: ik/httpclient-4.5.2.jar  
  inflating: ik/httpcore-4.4.4.jar   
  inflating: ik/commons-logging-1.2.jar  
  inflating: ik/commons-codec-1.9.jar  
  inflating: ik/plugin-descriptor.properties  
  inflating: ik/plugin-security.policy  
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment">#</span>
<span class="token comment">#ç§»åŠ¨åˆ°pluginsç›®å½•ä¸‹</span>
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># mv ik plugins/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>rm -rf *.zip</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">[root@0adeb7852e00 elasticsearch]# rm -rf elasticsearch-analysis-ik-7.6.2.zip <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>ç¡®è®¤æ˜¯å¦å®‰è£…å¥½äº†åˆ†è¯å™¨</p>
<h5 id="ï¼ˆ2ï¼‰æµ‹è¯•åˆ†è¯å™¨"><a href="#ï¼ˆ2ï¼‰æµ‹è¯•åˆ†è¯å™¨" class="headerlink" title="ï¼ˆ2ï¼‰æµ‹è¯•åˆ†è¯å™¨"></a>ï¼ˆ2ï¼‰æµ‹è¯•åˆ†è¯å™¨</h5><p>ä½¿ç”¨é»˜è®¤</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET my_index/_analyze
<span class="token punctuation">&#123;</span>
   <span class="token property">"text"</span><span class="token operator">:</span><span class="token string">"æˆ‘æ˜¯ä¸­å›½äºº"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¯·è§‚å¯Ÿæ‰§è¡Œç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"tokens"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æˆ‘"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æ˜¯"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"ä¸­"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"å›½"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"äºº"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC>"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">4</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET my_index/_analyze
<span class="token punctuation">&#123;</span>
   <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_smart"</span><span class="token punctuation">,</span> 
   <span class="token property">"text"</span><span class="token operator">:</span><span class="token string">"æˆ‘æ˜¯ä¸­å›½äºº"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"tokens"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æˆ‘"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_CHAR"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æ˜¯"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_CHAR"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"ä¸­å›½äºº"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET my_index/_analyze
<span class="token punctuation">&#123;</span>
   <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span> 
   <span class="token property">"text"</span><span class="token operator">:</span><span class="token string">"æˆ‘æ˜¯ä¸­å›½äºº"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"tokens"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æˆ‘"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_CHAR"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æ˜¯"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_CHAR"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"ä¸­å›½äºº"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"ä¸­å›½"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"å›½äºº"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">4</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ï¼ˆ3ï¼‰è‡ªå®šä¹‰è¯åº“"><a href="#ï¼ˆ3ï¼‰è‡ªå®šä¹‰è¯åº“" class="headerlink" title="ï¼ˆ3ï¼‰è‡ªå®šä¹‰è¯åº“"></a>ï¼ˆ3ï¼‰è‡ªå®šä¹‰è¯åº“</h5><ul>
<li>ä¿®æ”¹/usr/share/elasticsearch/plugins/ik/configä¸­çš„IKAnalyzer.cfg.xml<br>/usr/share/elasticsearch/plugins/ik/config</li>
</ul>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">"http://java.sun.com/dtd/properties.dtd"</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">></span></span>IK Analyzer æ‰©å±•é…ç½®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">></span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ext_dict<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>
	 <span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ext_stopwords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remote_ext_dict<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>http://192.168.137.14/es/fenci.txt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span> 
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--></span>
	<span class="token comment">&lt;!-- &lt;entry key="remote_ext_stopwords">words_location&lt;/entry> --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åŸæ¥çš„xml</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">"http://java.sun.com/dtd/properties.dtd"</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">></span></span>IK Analyzer æ‰©å±•é…ç½®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">></span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ext_dict<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>
	 <span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ext_stopwords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --></span>
	<span class="token comment">&lt;!-- &lt;entry key="remote_ext_dict">words_location&lt;/entry> --></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--></span>
	<span class="token comment">&lt;!-- &lt;entry key="remote_ext_stopwords">words_location&lt;/entry> --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¿®æ”¹å®Œæˆåï¼Œéœ€è¦é‡å¯elasticsearchå®¹å™¨ï¼Œå¦åˆ™ä¿®æ”¹ä¸ç”Ÿæ•ˆã€‚</p>
<p>æ›´æ–°å®Œæˆåï¼Œesåªä¼šå¯¹äºæ–°å¢çš„æ•°æ®ç”¨æ›´æ–°åˆ†è¯ã€‚å†å²æ•°æ®æ˜¯ä¸ä¼šé‡æ–°åˆ†è¯çš„ã€‚å¦‚æœæƒ³è¦å†å²æ•°æ®é‡æ–°åˆ†è¯ï¼Œéœ€è¦æ‰§è¡Œï¼š</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">POST my_index/_update_by_query?conflicts<span class="token operator">=</span>proceed<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<p><a target="_blank" rel="noopener" href="http://192.168.137.14/es/fenci.txt%EF%BC%8C%E8%BF%99%E4%B8%AA%E6%98%AFnginx%E4%B8%8A%E8%B5%84%E6%BA%90%E7%9A%84%E8%AE%BF%E9%97%AE%E8%B7%AF%E5%BE%84">http://192.168.137.14/es/fenci.txtï¼Œè¿™ä¸ªæ˜¯nginxä¸Šèµ„æºçš„è®¿é—®è·¯å¾„</a></p>
<p>åœ¨è¿è¡Œä¸‹é¢å®ä¾‹ä¹‹å‰ï¼Œéœ€è¦å®‰è£…nginxï¼ˆå®‰è£…æ–¹æ³•è§å®‰è£…nginxï¼‰ï¼Œç„¶ååˆ›å»ºâ€œfenci.txtâ€æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">echo</span> <span class="token string">"æ¨±æ¡ƒè¨å…¶é©¬ï¼Œå¸¦ä½ ç”œèœœå…¥å¤"</span> <span class="token operator">></span> /mydata/nginx/html/fenci.txt <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æµ‹è¯•æ•ˆæœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET my_index/_analyze
<span class="token punctuation">&#123;</span>
   <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span> 
   <span class="token property">"text"</span><span class="token operator">:</span><span class="token string">"æ¨±æ¡ƒè¨å…¶é©¬ï¼Œå¸¦ä½ ç”œèœœå…¥å¤"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"tokens"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"æ¨±æ¡ƒ"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"è¨å…¶é©¬"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"å¸¦ä½ "</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"ç”œèœœ"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"token"</span> <span class="token operator">:</span> <span class="token string">"å…¥å¤"</span><span class="token punctuation">,</span>
      <span class="token property">"start_offset"</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      <span class="token property">"end_offset"</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span> <span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
      <span class="token property">"position"</span> <span class="token operator">:</span> <span class="token number">4</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="4ã€elasticsearch-Rest-Client"><a href="#4ã€elasticsearch-Rest-Client" class="headerlink" title="4ã€elasticsearch-Rest-Client"></a>4ã€elasticsearch-Rest-Client</h3><h4 id="1ï¼‰9300-TCP"><a href="#1ï¼‰9300-TCP" class="headerlink" title="1ï¼‰9300: TCP"></a>1ï¼‰9300: TCP</h4><ul>
<li><p>spring-data-elasticsearch:transport-api.jar;</p>
<ul>
<li>springbootç‰ˆæœ¬ä¸åŒï¼Œransport-api.jarä¸åŒï¼Œä¸èƒ½é€‚é…esç‰ˆæœ¬</li>
<li>7.xå·²ç»ä¸å»ºè®®ä½¿ç”¨ï¼Œ8ä»¥åå°±è¦åºŸå¼ƒ<h4 id="2ï¼‰9200-HTTP"><a href="#2ï¼‰9200-HTTP" class="headerlink" title="2ï¼‰9200: HTTP"></a>2ï¼‰9200: HTTP</h4></li>
</ul>
</li>
<li><p>jestClient: éå®˜æ–¹ï¼Œæ›´æ–°æ…¢ï¼›</p>
</li>
<li><p>RestTemplateï¼šæ¨¡æ‹ŸHTTPè¯·æ±‚ï¼ŒESå¾ˆå¤šæ“ä½œéœ€è¦è‡ªå·±å°è£…ï¼Œéº»çƒ¦ï¼›</p>
</li>
<li><p>HttpClientï¼šåŒä¸Šï¼›</p>
</li>
<li><p>Elasticsearch-Rest-Clientï¼šå®˜æ–¹RestClientï¼Œå°è£…äº†ESæ“ä½œï¼ŒAPIå±‚æ¬¡åˆ†æ˜ï¼Œä¸Šæ‰‹ç®€å•ï¼›<br>æœ€ç»ˆé€‰æ‹©Elasticsearch-Rest-Clientï¼ˆelasticsearch-rest-high-level-clientï¼‰ï¼›<br> <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html</a> </p>
</li>
</ul>
<h3 id="5ã€é™„å½•ï¼šå®‰è£…Nginx"><a href="#5ã€é™„å½•ï¼šå®‰è£…Nginx" class="headerlink" title="5ã€é™„å½•ï¼šå®‰è£…Nginx"></a>5ã€é™„å½•ï¼šå®‰è£…Nginx</h3><ul>
<li><p>éšä¾¿å¯åŠ¨ä¸€ä¸ªnginxå®ä¾‹ï¼Œåªæ˜¯ä¸ºäº†å¤åˆ¶å‡ºé…ç½®</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker run -p80:80 --name nginx -d nginx:1.10   <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>å°†å®¹å™¨å†…çš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°/mydata/nginx/conf/ ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">mkdir</span> -p /mydata/nginx/html
<span class="token function">mkdir</span> -p /mydata/nginx/logs
<span class="token function">mkdir</span> -p /mydata/nginx/conf
docker container <span class="token function">cp</span> nginx:/etc/nginx/*  /mydata/nginx/conf/ 
<span class="token comment">#ç”±äºæ‹·è´å®Œæˆåä¼šåœ¨configä¸­å­˜åœ¨ä¸€ä¸ªnginxæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥éœ€è¦å°†å®ƒçš„å†…å®¹ç§»åŠ¨åˆ°confä¸­</span>
<span class="token function">mv</span> /mydata/nginx/conf/nginx/* /mydata/nginx/conf/
<span class="token function">rm</span> -rf /mydata/nginx/conf/nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>ç»ˆæ­¢åŸå®¹å™¨ï¼š</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker stop nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>æ‰§è¡Œå‘½ä»¤åˆ é™¤åŸå®¹å™¨ï¼š</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker <span class="token function">rm</span> nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>åˆ›å»ºæ–°çš„Nginxï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker run -p <span class="token number">80</span>:80 --name nginx <span class="token punctuation">\</span>
 -v /mydata/nginx/html:/usr/share/nginx/html <span class="token punctuation">\</span>
 -v /mydata/nginx/logs:/var/log/nginx <span class="token punctuation">\</span>
 -v /mydata/nginx/conf/:/etc/nginx <span class="token punctuation">\</span>
 -d nginx:1.10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>è®¾ç½®å¼€æœºå¯åŠ¨nginx</p>
<pre class="line-numbers language-none"><code class="language-none">docker update nginx --restart&#x3D;always<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>åˆ›å»ºâ€œ/mydata/nginx/html/index.htmlâ€æ–‡ä»¶ï¼Œæµ‹è¯•æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è®¿é—®</p>
<pre class="line-numbers language-none"><code class="language-none">echo &#39;&lt;h2&gt;hello nginx!&lt;&#x2F;h2&gt;&#39; &gt;index.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®¿é—®ï¼š<a target="_blank" rel="noopener" href="http://ngixæ‰€åœ¨ä¸»æœºçš„ip/index.html">http://ngixæ‰€åœ¨ä¸»æœºçš„IP:80/index.html</a></p>
</li>
</ul>
<h2 id="SpringBootæ•´åˆElasticSearch"><a href="#SpringBootæ•´åˆElasticSearch" class="headerlink" title="SpringBootæ•´åˆElasticSearch"></a>SpringBootæ•´åˆElasticSearch</h2><h3 id="1ã€å¯¼å…¥ä¾èµ–"><a href="#1ã€å¯¼å…¥ä¾èµ–" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h3><p>è¿™é‡Œçš„ç‰ˆæœ¬è¦å’Œæ‰€æŒ‰ç…§çš„ELKç‰ˆæœ¬åŒ¹é…ã€‚</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>åœ¨spring-boot-dependenciesä¸­æ‰€ä¾èµ–çš„ELKç‰ˆæœ¬ä½6.8.7</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;elasticsearch.version&gt;6.8.7&lt;&#x2F;elasticsearch.version&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/img/spring-cloud/image-20200511074437763.png" alt="image-20200511074437763"></p>
<p>éœ€è¦åœ¨é¡¹ç›®ä¸­å°†å®ƒæ”¹ä¸º7.6.2</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
    ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elasticsearch.version</span><span class="token punctuation">></span></span>7.6.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>elasticsearch.version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2ã€ç¼–å†™æµ‹è¯•ç±»"><a href="#2ã€ç¼–å†™æµ‹è¯•ç±»" class="headerlink" title="2ã€ç¼–å†™æµ‹è¯•ç±»"></a>2ã€ç¼–å†™æµ‹è¯•ç±»</h3><h4 id="1ï¼‰æµ‹è¯•ä¿å­˜æ•°æ®"><a href="#1ï¼‰æµ‹è¯•ä¿å­˜æ•°æ®" class="headerlink" title="1ï¼‰æµ‹è¯•ä¿å­˜æ•°æ®"></a>1ï¼‰æµ‹è¯•ä¿å­˜æ•°æ®</h4><p> <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-document-index.html">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-document-index.html</a> </p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">indexData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">IndexRequest</span> indexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span> <span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token string">"ç”·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> jsonString <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®è¦ä¿å­˜çš„å†…å®¹</span>
    indexRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ‰§è¡Œåˆ›å»ºç´¢å¼•å’Œä¿å­˜æ•°æ®</span>
    <span class="token class-name">IndexResponse</span> index <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexRequest<span class="token punctuation">,</span> <span class="token class-name">GulimallElasticSearchConfig</span><span class="token punctuation">.</span>COMMON_OPTIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æµ‹è¯•å‰ï¼š</p>
<p><img src="/img/spring-cloud/image-20200511111618183.png" alt="image-20200511111618183"></p>
<p>æµ‹è¯•åï¼š</p>
<p><img src="/img/spring-cloud/image-20200511112025327.png" alt="image-20200511112025327"></p>
<h4 id="2ï¼‰æµ‹è¯•è·å–æ•°æ®"><a href="#2ï¼‰æµ‹è¯•è·å–æ•°æ®" class="headerlink" title="2ï¼‰æµ‹è¯•è·å–æ•°æ®"></a>2ï¼‰æµ‹è¯•è·å–æ•°æ®</h4><p> <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-search.html">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-search.html</a> </p>
<pre class="line-numbers language-none"><code class="language-none">@Test
public void searchData() throws IOException &#123;
    GetRequest getRequest &#x3D; new GetRequest(
            &quot;users&quot;,
            &quot;_-2vAHIB0nzmLJLkxKWk&quot;);

    GetResponse getResponse &#x3D; client.get(getRequest, RequestOptions.DEFAULT);
    System.out.println(getResponse);
    String index &#x3D; getResponse.getIndex();
    System.out.println(index);
    String id &#x3D; getResponse.getId();
    System.out.println(id);
    if (getResponse.isExists()) &#123;
        long version &#x3D; getResponse.getVersion();
        System.out.println(version);
        String sourceAsString &#x3D; getResponse.getSourceAsString();
        System.out.println(sourceAsString);
        Map&lt;String, Object&gt; sourceAsMap &#x3D; getResponse.getSourceAsMap();
        System.out.println(sourceAsMap);
        byte[] sourceAsBytes &#x3D; getResponse.getSourceAsBytes();
    &#125; else &#123;

    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p>æŸ¥è¯¢state=â€AKâ€çš„æ–‡æ¡£ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"took"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">"timed_out"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
	<span class="token property">"_shards"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
		<span class="token property">"successful"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
		<span class="token property">"skipped"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
		<span class="token property">"failed"</span><span class="token operator">:</span> <span class="token number">0</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token property">"hits"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token property">"total"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
			<span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>   <span class="token comment">//åŒ¹é…åˆ°äº†22æ¡</span>
			<span class="token property">"relation"</span><span class="token operator">:</span> <span class="token string">"eq"</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
		<span class="token property">"max_score"</span><span class="token operator">:</span> <span class="token number">3.7952394</span><span class="token punctuation">,</span>
		<span class="token property">"hits"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
			<span class="token property">"_index"</span><span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
			<span class="token property">"_type"</span><span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
			<span class="token property">"_id"</span><span class="token operator">:</span> <span class="token string">"210"</span><span class="token punctuation">,</span>
			<span class="token property">"_score"</span><span class="token operator">:</span> <span class="token number">3.7952394</span><span class="token punctuation">,</span>
			<span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
				<span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token number">210</span><span class="token punctuation">,</span>
				<span class="token property">"balance"</span><span class="token operator">:</span> <span class="token number">33946</span><span class="token punctuation">,</span>
				<span class="token property">"firstname"</span><span class="token operator">:</span> <span class="token string">"Cherry"</span><span class="token punctuation">,</span>
				<span class="token property">"lastname"</span><span class="token operator">:</span> <span class="token string">"Carey"</span><span class="token punctuation">,</span>
				<span class="token property">"age"</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
				<span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
				<span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"539 Tiffany Place"</span><span class="token punctuation">,</span>
				<span class="token property">"employer"</span><span class="token operator">:</span> <span class="token string">"Martgo"</span><span class="token punctuation">,</span>
				<span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"cherrycarey@martgo.com"</span><span class="token punctuation">,</span>
				<span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"Fairacres"</span><span class="token punctuation">,</span>
				<span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"AK"</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
           ....<span class="token comment">//çœç•¥å…¶ä»–</span>
          <span class="token punctuation">]</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œå¹³å‡è–ªèµ„</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET bank/_search
<span class="token punctuation">&#123;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"Mill"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">10</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"ageAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"balanceAvg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"avg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>javaå®ç°</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * å¤æ‚æ£€ç´¢:åœ¨bankä¸­æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œå¹³å‡è–ªèµ„
 * @throws IOException
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">searchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//1. åˆ›å»ºæ£€ç´¢è¯·æ±‚</span>
    <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//1.1ï¼‰æŒ‡å®šç´¢å¼•</span>
    searchRequest<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">"bank"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1.2ï¼‰æ„é€ æ£€ç´¢æ¡ä»¶</span>
    <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">"address"</span><span class="token punctuation">,</span><span class="token string">"Mill"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//1.2.1)æŒ‰ç…§å¹´é¾„åˆ†å¸ƒè¿›è¡Œèšåˆ</span>
    <span class="token class-name">TermsAggregationBuilder</span> ageAgg<span class="token operator">=</span><span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">terms</span><span class="token punctuation">(</span><span class="token string">"ageAgg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>ageAgg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//1.2.2)è®¡ç®—å¹³å‡å¹´é¾„</span>
    <span class="token class-name">AvgAggregationBuilder</span> ageAvg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">"ageAvg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>ageAvg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1.2.3)è®¡ç®—å¹³å‡è–ªèµ„</span>
    <span class="token class-name">AvgAggregationBuilder</span> balanceAvg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">"balanceAvg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">"balance"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>balanceAvg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ£€ç´¢æ¡ä»¶ï¼š"</span><span class="token operator">+</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    searchRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2. æ‰§è¡Œæ£€ç´¢</span>
    <span class="token class-name">SearchResponse</span> searchResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ£€ç´¢ç»“æœï¼š"</span><span class="token operator">+</span>searchResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3. å°†æ£€ç´¢ç»“æœå°è£…ä¸ºBean</span>
    <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> searchHits <span class="token operator">=</span> hits<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> searchHit <span class="token operator">:</span> searchHits<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">String</span> sourceAsString <span class="token operator">=</span> searchHit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Account</span> account <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>sourceAsString<span class="token punctuation">,</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token comment">//4. è·å–èšåˆä¿¡æ¯</span>
    <span class="token class-name">Aggregations</span> aggregations <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Terms</span> ageAgg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"ageAgg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Terms<span class="token punctuation">.</span>Bucket</span> bucket <span class="token operator">:</span> ageAgg1<span class="token punctuation">.</span><span class="token function">getBuckets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">String</span> keyAsString <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">getKeyAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¹´é¾„ï¼š"</span><span class="token operator">+</span>keyAsString<span class="token operator">+</span><span class="token string">" ==> "</span><span class="token operator">+</span>bucket<span class="token punctuation">.</span><span class="token function">getDocCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name">Avg</span> ageAvg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"ageAvg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¹³å‡å¹´é¾„ï¼š"</span><span class="token operator">+</span>ageAvg1<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Avg</span> balanceAvg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"balanceAvg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¹³å‡è–ªèµ„ï¼š"</span><span class="token operator">+</span>balanceAvg1<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥å°è¯•å¯¹æ¯”æ‰“å°çš„æ¡ä»¶å’Œæ‰§è¡Œç»“æœï¼Œå’Œå‰é¢çš„ElasticSearchçš„æ£€ç´¢è¯­å¥å’Œæ£€ç´¢ç»“æœè¿›è¡Œæ¯”è¾ƒï¼›</p>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="1-kibanaæ§åˆ¶å°å‘½ä»¤"><a href="#1-kibanaæ§åˆ¶å°å‘½ä»¤" class="headerlink" title="1. kibanaæ§åˆ¶å°å‘½ä»¤"></a>1. kibanaæ§åˆ¶å°å‘½ä»¤</h3><p>ctrl+homeï¼šå›åˆ°æ–‡æ¡£é¦–éƒ¨ï¼›</p>
<p>ctril+endï¼šå›åˆ°æ–‡æ¡£å°¾éƒ¨ã€‚</p>

                
                
                    <br />
                    <!-- post-content-ad -->
                    <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-3409699730406381"
                            data-ad-slot="9289016056"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                    <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                

                <br>
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/Java/spring-cloud/mall-high-availability-cluster/" data-toggle="tooltip" data-placement="top" title="ã€Spring-cloudã€‘guliå•†åŸ-é«˜å¯ç”¨é›†ç¾¤">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/Java/spring-cloud/mall-distributed-base/" data-toggle="tooltip" data-placement="top" title="ã€Spring-cloudã€‘guliå•†åŸ-åˆ†å¸ƒå¼åŸºç¡€">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!--æ‰“èµ-->
                
                    <div class="reward">
                        <div class="reward-button">èµ <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="/img/reward/alipay.jpg"><b>æ”¯ä»˜å®æ‰“èµ</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="/img/reward/wechat_pay.jpg"><b>å¾®ä¿¡æ‰“èµ</b> </span>
                            </span></div>
                        <p class="reward-notice">èµèµä¸€ä¸‹</p>
                    </div>
                
                <!--æ‰“èµ-->

                <br>
                <!--åˆ†äº«-->
                
                    <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                    <!--  css & js -->
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!--åˆ†äº«-->
                <br>                       
                
                <!-- require APlayer -->
                
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
                <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script>

                <div class="aplayer"
                    data-id="2297428102"
                    data-server="netease"
                    data-type="playlist"
                    data-fixed="true" >
                </div>
                

                
        
                    
                        <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  --> 
                        <div id="lv-container" data-id="city" data-uid="MTAyMC80Mzg3OC8yMDQxMw==">
                            <script type="text/javascript">
                                (function (d, s) {
                                    var j, e = d.getElementsByTagName(s)[0];
        
                                    if (typeof LivereTower === 'function') { return; }
        
                                    j = d.createElement(s);
                                    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                                    j.async = true;
        
                                    e.parentNode.insertBefore(j, e);
                                })(document, 'script');
                            </script>
                            <noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
                        </div>
                        <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
                    
            </div>
            
            <!-- Table of Contents -->
            
  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        <!-- toc -->
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#1-ELASTICSEARCH"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">1. ELASTICSEARCH</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85elastic-search"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">1ã€å®‰è£…elastic search</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2%E3%80%81%E5%88%9D%E6%AD%A5%E6%A3%80%E7%B4%A2"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">2ã€åˆæ­¥æ£€ç´¢</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1%EF%BC%89-CAT"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">1ï¼‰_CAT</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2%EF%BC%89%E7%B4%A2%E5%BC%95%E4%B8%80%E4%B8%AA%E6%96%87%E6%A1%A3"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">2ï¼‰ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#3%EF%BC%89%E6%9F%A5%E7%9C%8B%E6%96%87%E6%A1%A3"><span class="toc-nav-number">1.2.3.</span> <span class="toc-nav-text">3ï¼‰æŸ¥çœ‹æ–‡æ¡£</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#4%EF%BC%89%E6%9B%B4%E6%96%B0%E6%96%87%E6%A1%A3"><span class="toc-nav-number">1.2.4.</span> <span class="toc-nav-text">4ï¼‰æ›´æ–°æ–‡æ¡£</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#5%EF%BC%89%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3%E6%88%96%E7%B4%A2%E5%BC%95"><span class="toc-nav-number">1.2.5.</span> <span class="toc-nav-text">5ï¼‰åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#6%EF%BC%89eleasticsearch%E7%9A%84%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94bulk"><span class="toc-nav-number">1.2.6.</span> <span class="toc-nav-text">6ï¼‰eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#7%EF%BC%89%E6%A0%B7%E6%9C%AC%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE"><span class="toc-nav-number">1.2.7.</span> <span class="toc-nav-text">7ï¼‰æ ·æœ¬æµ‹è¯•æ•°æ®</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3%E3%80%81%E6%A3%80%E7%B4%A2"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">3ã€æ£€ç´¢</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1%EF%BC%89search-Api"><span class="toc-nav-number">1.3.1.</span> <span class="toc-nav-text">1ï¼‰search Api</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2%EF%BC%89Query-DSL"><span class="toc-nav-number">1.3.2.</span> <span class="toc-nav-text">2ï¼‰Query DSL</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%881%EF%BC%89%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-nav-number">1.3.2.1.</span> <span class="toc-nav-text">ï¼ˆ1ï¼‰åŸºæœ¬è¯­æ³•æ ¼å¼</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%882%EF%BC%89%E8%BF%94%E5%9B%9E%E9%83%A8%E5%88%86%E5%AD%97%E6%AE%B5"><span class="toc-nav-number">1.3.2.2.</span> <span class="toc-nav-text">ï¼ˆ2ï¼‰è¿”å›éƒ¨åˆ†å­—æ®µ</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%883%EF%BC%89match%E5%8C%B9%E9%85%8D%E6%9F%A5%E8%AF%A2"><span class="toc-nav-number">1.3.2.3.</span> <span class="toc-nav-text">ï¼ˆ3ï¼‰matchåŒ¹é…æŸ¥è¯¢</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%884%EF%BC%89-match-phrase-%E7%9F%AD%E5%8F%A5%E5%8C%B9%E9%85%8D"><span class="toc-nav-number">1.3.2.4.</span> <span class="toc-nav-text">ï¼ˆ4ï¼‰ match_phrase [çŸ­å¥åŒ¹é…]</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%885%EF%BC%89multi-math%E3%80%90%E5%A4%9A%E5%AD%97%E6%AE%B5%E5%8C%B9%E9%85%8D%E3%80%91"><span class="toc-nav-number">1.3.2.5.</span> <span class="toc-nav-text">ï¼ˆ5ï¼‰multi_mathã€å¤šå­—æ®µåŒ¹é…ã€‘</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%886%EF%BC%89bool%E7%94%A8%E6%9D%A5%E5%81%9A%E5%A4%8D%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-nav-number">1.3.2.6.</span> <span class="toc-nav-text">ï¼ˆ6ï¼‰boolç”¨æ¥åšå¤åˆæŸ¥è¯¢</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%887%EF%BC%89Filter%E3%80%90%E7%BB%93%E6%9E%9C%E8%BF%87%E6%BB%A4%E3%80%91"><span class="toc-nav-number">1.3.2.7.</span> <span class="toc-nav-text">ï¼ˆ7ï¼‰Filterã€ç»“æœè¿‡æ»¤ã€‘</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%888%EF%BC%89term"><span class="toc-nav-number">1.3.2.8.</span> <span class="toc-nav-text">ï¼ˆ8ï¼‰term</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%889%EF%BC%89Aggregation%EF%BC%88%E6%89%A7%E8%A1%8C%E8%81%9A%E5%90%88%EF%BC%89"><span class="toc-nav-number">1.3.2.9.</span> <span class="toc-nav-text">ï¼ˆ9ï¼‰Aggregationï¼ˆæ‰§è¡Œèšåˆï¼‰</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#3%EF%BC%89Mapping"><span class="toc-nav-number">1.3.3.</span> <span class="toc-nav-text">3ï¼‰Mapping</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%881%EF%BC%89%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B"><span class="toc-nav-number">1.3.3.1.</span> <span class="toc-nav-text">ï¼ˆ1ï¼‰å­—æ®µç±»å‹</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%882%EF%BC%89%E6%98%A0%E5%B0%84"><span class="toc-nav-number">1.3.3.2.</span> <span class="toc-nav-text">ï¼ˆ2ï¼‰æ˜ å°„</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%883%EF%BC%89%E6%96%B0%E7%89%88%E6%9C%AC%E6%94%B9%E5%8F%98"><span class="toc-nav-number">1.3.3.3.</span> <span class="toc-nav-text">ï¼ˆ3ï¼‰æ–°ç‰ˆæœ¬æ”¹å˜</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84"><span class="toc-nav-number">1.3.3.3.1.</span> <span class="toc-nav-text">åˆ›å»ºæ˜ å°„</span></a></li><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%98%A0%E5%B0%84"><span class="toc-nav-number">1.3.3.3.2.</span> <span class="toc-nav-text">æŸ¥çœ‹æ˜ å°„</span></a></li><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%B0%E7%9A%84%E5%AD%97%E6%AE%B5%E6%98%A0%E5%B0%84"><span class="toc-nav-number">1.3.3.3.3.</span> <span class="toc-nav-text">æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„</span></a></li><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%E6%9B%B4%E6%96%B0%E6%98%A0%E5%B0%84"><span class="toc-nav-number">1.3.3.3.4.</span> <span class="toc-nav-text">æ›´æ–°æ˜ å°„</span></a></li><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="toc-nav-number">1.3.3.3.5.</span> <span class="toc-nav-text">æ•°æ®è¿ç§»</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#4%EF%BC%89%E5%88%86%E8%AF%8D"><span class="toc-nav-number">1.3.4.</span> <span class="toc-nav-text">4ï¼‰åˆ†è¯</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%881%EF%BC%89%E5%AE%89%E8%A3%85ik%E5%88%86%E8%AF%8D%E5%99%A8"><span class="toc-nav-number">1.3.4.1.</span> <span class="toc-nav-text">ï¼ˆ1ï¼‰å®‰è£…ikåˆ†è¯å™¨</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%EF%BC%881%EF%BC%89%E6%9F%A5%E7%9C%8Belasticsearch%E7%89%88%E6%9C%AC%E5%8F%B7%EF%BC%9A"><span class="toc-nav-number">1.3.4.1.1.</span> <span class="toc-nav-text">ï¼ˆ1ï¼‰æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·ï¼š</span></a></li><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#%EF%BC%882%EF%BC%89%E8%BF%9B%E5%85%A5es%E5%AE%B9%E5%99%A8%E5%86%85%E9%83%A8plugin%E7%9B%AE%E5%BD%95"><span class="toc-nav-number">1.3.4.1.2.</span> <span class="toc-nav-text">ï¼ˆ2ï¼‰è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%882%EF%BC%89%E6%B5%8B%E8%AF%95%E5%88%86%E8%AF%8D%E5%99%A8"><span class="toc-nav-number">1.3.4.2.</span> <span class="toc-nav-text">ï¼ˆ2ï¼‰æµ‹è¯•åˆ†è¯å™¨</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%EF%BC%883%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%8D%E5%BA%93"><span class="toc-nav-number">1.3.4.3.</span> <span class="toc-nav-text">ï¼ˆ3ï¼‰è‡ªå®šä¹‰è¯åº“</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4%E3%80%81elasticsearch-Rest-Client"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">4ã€elasticsearch-Rest-Client</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1%EF%BC%899300-TCP"><span class="toc-nav-number">1.4.1.</span> <span class="toc-nav-text">1ï¼‰9300: TCP</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2%EF%BC%899200-HTTP"><span class="toc-nav-number">1.4.2.</span> <span class="toc-nav-text">2ï¼‰9200: HTTP</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5%E3%80%81%E9%99%84%E5%BD%95%EF%BC%9A%E5%AE%89%E8%A3%85Nginx"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">5ã€é™„å½•ï¼šå®‰è£…Nginx</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#SpringBoot%E6%95%B4%E5%90%88ElasticSearch"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">SpringBootæ•´åˆElasticSearch</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1%E3%80%81%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">1ã€å¯¼å…¥ä¾èµ–</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2%E3%80%81%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">2ã€ç¼–å†™æµ‹è¯•ç±»</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1%EF%BC%89%E6%B5%8B%E8%AF%95%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="toc-nav-number">2.2.1.</span> <span class="toc-nav-text">1ï¼‰æµ‹è¯•ä¿å­˜æ•°æ®</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2%EF%BC%89%E6%B5%8B%E8%AF%95%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-nav-number">2.2.2.</span> <span class="toc-nav-text">2ï¼‰æµ‹è¯•è·å–æ•°æ®</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">å…¶ä»–</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-kibana%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">1. kibanaæ§åˆ¶å°å‘½ä»¤</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Recommended Posts  -->
                
                    <hr>
                    <h5>æ¨èæ–‡ç« </h5>
                    

    <div class="recommended_posts">
        <ul>
            
                <li><a href="https://fangzhioo.github.io/Java/spring-cloud/mall-high-availability-cluster/">ã€Spring-cloudã€‘guliå•†åŸ-é«˜å¯ç”¨é›†ç¾¤</a></li>
            
                <li><a href="https://fangzhioo.github.io/Java/spring-cloud/mall-distributed-base/">ã€Spring-cloudã€‘guliå•†åŸ-åˆ†å¸ƒå¼åŸºç¡€</a></li>
            
        </ul>
    </div>
 
                

                <!-- Featured Tags -->
                
                <section>
                    <div class="tags">
                        
                            <a class="tag" href="/tags/#SpringCloud" title="SpringCloud">SpringCloud</a>
                        
                            <a class="tag" href="/tags/#ElasticSearch" title="ElasticSearch">ElasticSearch</a>
                        
                    </div>
                </section>
                
            </div>
        </div>
    </div>
</article>

<!-- å¤åˆ¶æ·»åŠ ç‰ˆæƒç”³æ˜-->
<script>
    /**/
    function setClipboardText(event){
        event.preventDefault();//é˜»æ­¢å…ƒç´ å‘ç”Ÿé»˜è®¤çš„è¡Œä¸ºï¼ˆä¾‹å¦‚ï¼Œå½“ç‚¹å‡»æäº¤æŒ‰é’®æ—¶é˜»æ­¢å¯¹è¡¨å•çš„æäº¤ï¼‰ã€‚
        var node = document.createElement('div');
        //å¯¹documentfragmentä¸ç†Ÿï¼Œä¸çŸ¥é“æ€ä¹ˆè·å–é‡Œé¢çš„å†…å®¹ï¼Œç”¨äº†ä¸€ä¸ªæ¯”è¾ƒç¬¨çš„æ–¹å¼
        node.appendChild(window.getSelection().getRangeAt(0).cloneContents());
        //getRangeAt(0)è¿”å›å¯¹åŸºäºé›¶çš„æ•°å­—ç´¢å¼•ä¸ä¼ é€’å‚æ•°åŒ¹é…çš„é€‰æ‹©å¯¹è±¡ä¸­çš„èŒƒå›´çš„å¼•ç”¨ã€‚å¯¹äºè¿ç»­é€‰æ‹©ï¼Œå‚æ•°åº”ä¸ºé›¶ã€‚
        var htmlData = '<div>'
            + node.innerHTML
            + '<br /><br />è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚<br />'
            + 'å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚<br />'
            + 'ä½œè€…ï¼šfangzhioo <br />é“¾æ¥ï¼š'
            + location.href
            + '<br />æ¥æºï¼šfangzhioo.github.io<br /><br />'
            + '</div>';
        var textData = window.getSelection().getRangeAt(0)
            + '\n\nè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚\n'
            + 'å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n'
            + 'ä½œè€…ï¼šfangzhioo\n'
            + 'é“¾æ¥ï¼š'
            + location.href
            + 'æ¥æºï¼šfangzhioo.github.io\n\n';
        if(event.clipboardData){
            event.clipboardData.setData("text/html", htmlData);
            //setData(å‰ªè´´æ¿æ ¼å¼, æ•°æ®) ç»™å‰ªè´´æ¿èµ‹äºˆæŒ‡å®šæ ¼å¼çš„æ•°æ®ã€‚è¿”å› true è¡¨ç¤ºæ“ä½œæˆåŠŸã€‚
            event.clipboardData.setData("text/plain",textData);
        }
        else if(window.clipboardData){ //window.clipboardDataçš„ä½œç”¨æ˜¯åœ¨é¡µé¢ä¸Šå°†éœ€è¦çš„ä¸œè¥¿å¤åˆ¶åˆ°å‰ªè´´æ¿ä¸Šï¼Œæä¾›äº†å¯¹äºé¢„å®šä¹‰çš„å‰ªè´´æ¿æ ¼å¼çš„è®¿é—®ï¼Œä»¥ä¾¿åœ¨ç¼–è¾‘æ“ä½œä¸­ä½¿ç”¨ã€‚
            return window.clipboardData.setData("text", textData);
        }
    };
 
    document.addEventListener('copy',function(e){
        setClipboardText(e);
    });
</script>

<!-- smooth scroll behavior polyfill  -->
<!-- <script type="text/javascript" src="/js/smoothscroll.js"></script> -->



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/fang-zhi-4-73">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/fangzhioooo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/fangzhioo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; æ–¹å¿— 2021 
                    <br>
                    Theme by <a target="_blank" rel="noopener" href="https://huangxuan.me/">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="https://fangzhioo.github.io">Fz</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=fangzhioo&repo=fangzhioo.github.io&type=star&count=true" >
                    </iframe>
                    <br />
                    <!--æ€»è®¿é—®é‡ç»Ÿè®¡-->
                    
                        <span id="busuanzi_container_site_pv" style="margin-left: 3px;">
                            æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
                        </span>
                    
                    <!--æ€»è®¿é—®é‡ç»Ÿè®¡-->

                </p>
            </div>
        </div>
    </div>
</footer>

<!-- Custom Theme JavaScript -->

<script src="/js/my-blog.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://fangzhioo.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-138588101-1';
    var _gaDomain = 'fangzhioo.github.io';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'dce5d892b228cc0a253520da429e7f11';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://fangzhioo.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

<!-- live2d -->
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":true,"debug":false,"model":{"position":"right","width":200,"height":400,"jsonPath":"/live2dw/assets/sagiri.model.json"},"mobile":{"show":true},"react":{"opacity":0.6},"log":false});</script>

</body>

</html>
